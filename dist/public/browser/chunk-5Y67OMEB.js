import{a as B,b as Q,c as R,d as V,e as H,f as p}from"./chunk-KPWGPVIW.js";import{ib as N,jb as U,lb as q}from"./chunk-WTQDWVXZ.js";import"./chunk-D4MMWRT4.js";import{a as j}from"./chunk-U73KLQZJ.js";import"./chunk-T5EURV5D.js";import{a as A}from"./chunk-UQUUNODN.js";import"./chunk-K7PIUIFR.js";import"./chunk-6PYJZL2G.js";import"./chunk-PO2RMC3Q.js";import"./chunk-GT4JH6HJ.js";import"./chunk-EBZKSOFQ.js";import"./chunk-KG3B2A6X.js";import{o as G,u as O}from"./chunk-AAYOZ3JU.js";import{a as T}from"./chunk-NMGGHNE5.js";import{a as L}from"./chunk-BIMAMPZW.js";import"./chunk-KNEUCQQI.js";import"./chunk-GKZUPR7X.js";import{k as F}from"./chunk-ZM3MROS5.js";import{m as I,t as M,v as D}from"./chunk-DP3M2V7L.js";import{Aa as h,C as s,Gc as W,Ic as E,Lb as v,Nc as m,Oc as c,Pb as C,Sb as g,Ub as y,bc as o,cc as a,dc as b,ec as x,fc as S,ja as d,n as f,oc as k,uc as w,vc as _,wa as r,wc as P,yc as l}from"./chunk-B7JMKZ3I.js";var Z=["calendar"],J=()=>[N,I,M],K=i=>({"opacity-50":i});function X(i,z){if(i&1&&(b(0,"full-calendar",8,0),m(2,"async"),m(3,"async")),i&2){let e=k();y("events",c(2,3,e.citasEvent))("ngClass",E(7,K,c(3,5,e.isLoading)))("options",e.calendarOptions)}}function Y(i,z){i&1&&(o(0,"h1"),l(1,"Loading..."),a())}var ke=(()=>{class i{constructor(){this.isLoading=r(T).isLoading,this.modalService=r(G),this.loadingCalendar=!1,this.citasService=r(j),this.userService=r(L),this.personalService=r(A),this.router=r(F),this.citasEvent=new f,this.personalId="",this.startWeek=p().startOfWeek,this.endWeek=p().endOfWeek,this.calendarOptions={plugins:[B,Q,R,V],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},eventMaxStack:1,allDaySlot:!1,expandRows:!0,slotLabelInterval:"00:05:00",slotMinTime:"08:00",slotMaxTime:"20:00:00",slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:!1,meridiem:"narrow"},eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},selectConstraint:"businessHours",initialView:"timeGridWeek",weekends:!0,editable:!0,loading:e=>{this.loadingCalendar=e},eventClick:this.handleEventClick.bind(this),selectAllow:e=>{let t=this.calendar?.getApi()?.view.type=="timeGridWeek",n=new Date;return n.setHours(0,0,0,0),e.start>=n&&t},selectable:!1,selectMirror:!0,dayMaxEvents:!0,locale:H,datesSet:e=>{this.startWeek=e.view.activeStart,this.endWeek=e.view.activeEnd,this.loadCitas(this.bodyParams)}}}ngOnInit(){this.getPersonalId()}get bodyParams(){return{id_personal:this.personalId,startWeek:this.startWeek,endWeek:this.endWeek}}getPersonalId(){this.personalService.getPersonalByUser(this.userService.user()?.id).pipe(s(e=>e.data.id_personal),d(e=>this.personalId=e),d(()=>this.loadCitas(this.bodyParams))).subscribe()}loadCitas(e){if(this.personalId)return this.citasEvent=this.citasService.getByPersonal(e).pipe(s(t=>t.data))}handleEventClick(e){let t=e.event,n=this.modalService.open(q,{centered:!0,size:"100",scrollable:!0,backdrop:"static"});window.document.body.classList.add("modal-open"),n.componentInstance.eventId=t.id,n.componentInstance.citaId=t.extendedProps.id_cita,n.componentInstance.eventUpdated.subscribe(()=>{this.loadCitas(this.bodyParams)})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-citas"]],viewQuery:function(t,n){if(t&1&&w(Z,5),t&2){let u;_(u=P())&&(n.calendar=u.first)}},standalone:!0,features:[W],decls:13,vars:0,consts:[["calendar",""],["header-title",""],[1,"d-flex","align-items-center","text-white","fw-bold","my-1"],[1,"content","d-flex","flex-column","flex-column-fluid"],["id","kt_content_container",1,"container-xxl"],[1,"card"],[1,"card-body",2,"border","none","box-shadow","0 4px 8px rgba(0, 0, 0, 0.1)","border-radius","0 0 15px 15px"],[1,"demo-app-main"],[3,"events","ngClass","options"]],template:function(t,n){t&1&&(o(0,"app-header"),x(1,1),o(2,"h1",2),l(3," Calendario de Citas "),a(),S(),a(),o(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),v(9,X,4,9)(10,Y,2,0),C(11,9,J,null,10),g(0,-1),a()()()()())},dependencies:[O,U,D]})}}return i})();export{ke as CitasComponent};
