import{a as I}from"./chunk-3LUZQXRF.js";import{a as ae}from"./chunk-3YJPJYYE.js";import{c as te,d as ie}from"./chunk-VW7FZU7U.js";import{a as ne}from"./chunk-MYRVSVX3.js";import{a as k,b as L}from"./chunk-73QAVBZN.js";import{a as M}from"./chunk-C4LB5HPP.js";import{b as P,i as Z,j as ee}from"./chunk-FR665RP3.js";import{g as K,k as Q,v as X,w as Y}from"./chunk-O36CONK3.js";import{f as H,g as J,j as x,l as E}from"./chunk-FM6AGUVW.js";import{Ac as z,B as y,Bc as U,C as D,Cc as W,Da as S,Ec as q,I as C,Kb as _,Kc as f,Lc as h,Na as N,Oa as O,Tb as g,Wa as j,ac as e,bc as t,cc as p,dc as G,ec as R,gc as V,mc as u,nc as w,qc as A,rb as $,t as v,wb as r,wc as o,xc as F,yc as B,za as l}from"./chunk-6QDZBSPE.js";function le(b,n){b&1&&(e(0,"div",15),o(1," No hay pacientes disponibles para seleccionar. "),t())}function pe(b,n){b&1&&p(0,"span",16)}var m,T=(m=class{constructor(){this.modal=l(P),this.paqueteService=l(I),this.pacienteService=l(ae),this.isLoading$=l(M).isLoading,this.paqueteId="",this.onSaveComplete=new j,this.pacientesList=new v,this.selectedPatient=null,this.isLoading=!1,this.fetchPacientes(),this.subscription=this.isLoading$.subscribe(n=>{this.isLoading=n})}get isPurchaseDisabled(){return this.isLoading||!this.selectedPatient}fetchPacientes(){this.pacientesList=this.pacienteService.getAll().pipe(L(this),C(n=>n.data||[]))}close(){this.modal.dismissAll(),this.subscription.unsubscribe()}purchase(){let n=typeof this.paqueteId=="string"?this.paqueteId:this.paqueteId.id_paquete;n&&this.selectedPatient?this.paqueteService.purchase(n,this.selectedPatient).subscribe({next:()=>{this.onSaveComplete.emit(),this.modal.dismissAll()},error:i=>{console.error("Error al comprar paquete:",i)}}):console.error("ID del paquete o paciente no proporcionados")}},m.\u0275fac=function(i){return new(i||m)},m.\u0275cmp=S({type:m,selectors:[["app-comprar-modal-usuarios"]],inputs:{paqueteId:"paqueteId"},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[q],decls:30,vars:16,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-handcart","text-white","me-2","fs-2hx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body","text-center"],["bindLabel","nombre","bindValue","id_paciente","placeholder","Selecciona un paciente",3,"ngModelChange","ngModel","items","disabled"],["class","mt-3 text-danger",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"mt-3","text-danger"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(i,a){if(i&1&&(e(0,"div",0)(1,"h4",1)(2,"span")(3,"i",2),p(4,"span",3)(5,"span",4)(6,"span",5),t()(),o(7," Adquirir Paquete "),t(),e(8,"button",6),u("click",function(){return a.close()}),e(9,"i",7),p(10,"span",3)(11,"span",4),t()()(),e(12,"div",8)(13,"p"),o(14,"\xBFEst\xE1s seguro de comprar este Paquete?"),t(),e(15,"p"),o(16,"Selecciona el paciente que desees para continuar con la compra."),t(),e(17,"ng-select",9),f(18,"async"),f(19,"async"),W("ngModelChange",function(c){return U(a.selectedPatient,c)||(a.selectedPatient=c),c}),t(),_(20,le,2,0,"div",10),f(21,"async"),t(),e(22,"div",11)(23,"button",12),u("click",function(){return a.close()}),o(24," Cancelar "),t(),e(25,"button",13),f(26,"async"),u("click",function(){return a.purchase()}),o(27," Comprar "),_(28,pe,1,0,"span",14),f(29,"async"),t()()),i&2){let s,c;r(17),z("ngModel",a.selectedPatient),g("items",h(18,6,a.pacientesList))("disabled",((s=h(19,8,a.pacientesList))==null?null:s.length)===0),r(3),g("ngIf",((c=h(21,10,a.pacientesList))==null?null:c.length)===0),r(5),g("disabled",h(26,12,a.isLoading$)||!a.selectedPatient),r(3),g("ngIf",h(29,14,a.isLoading$))}},dependencies:[Y,K,X,Q,E,J,x,ie,te]}),m);T=y([k({checkProperties:!0}),D("design:paramtypes",[])],T);function me(b,n){if(b&1){let i=V();e(0,"div",19)(1,"div",20)(2,"div",21),p(3,"img",22),t(),e(4,"div",23)(5,"h5",24),o(6),t(),e(7,"p",25)(8,"strong"),o(9,"Terapias:"),t(),o(10),t(),e(11,"p",25),o(12),t(),e(13,"p",25)(14,"strong"),o(15),t()(),e(16,"button",26),u("click",function(){let s=N(i).$implicit,c=w();return O(c.openComprarModal(s))}),p(17,"span",27),o(18," Comprar "),t()()()()}if(b&2){let i=n.$implicit,a=w();r(3),A("src",i.banner_url,$),A("alt",i.nombre),r(3),F(i.nombre),r(4),B(" ",a.getTerapiasNombres(i.terapias),""),r(2),F(i.descripcion),r(3),B("$",i.preciopaquete,"")}}var d,oe=(d=class{constructor(){this.paquetesService=l(I),this.isLoading=l(M).isLoading,this.theme=l(Z),this.modal=l(P),this.paquetesList=new v,this.localeText=ne}ngOnInit(){this.fetchPaquetes()}fetchPaquetes(){this.paquetesList=this.paquetesService.getAll().pipe(C(n=>(console.log("Paquetes recibidos:",n.data),n.data)),L(this))}loadTabla(){this.fetchPaquetes()}gridReady(n){this.gridApi=n.api}onFilterTextBoxChanged(){this.gridApi.setGridOption("quickFilterText",document.getElementById("paquete-search").value)}openComprarModal(n){let i=this.modal.open(T,{size:"300px",animation:!0,centered:!0});i.componentInstance.paquete=n}getTerapiasNombres(n){return n.map(i=>i.nombre).join(", ")}ngOnDestroy(){}},d.\u0275fac=function(i){return new(i||d)},d.\u0275cmp=S({type:d,selectors:[["app-paquetes"]],standalone:!0,features:[q],decls:23,vars:3,consts:[["header-title",""],[1,"d-flex","flex-column","text-gray-900","fw-bold","my-1"],[1,"",2,"color","white"],[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],[1,"d-flex","py-4","justify-content-between","align-items-center"],["data-kt-search-element","form","autocomplete","off",1,"position-relative"],["type","hidden"],[1,"ki-duotone","ki-magnifier","fs-2","search-icon","position-absolute","top-50","translate-middle-y","ms-4"],[1,"path1"],[1,"path2"],["type","search","id","paquete-search","name","search","placeholder","B\xFAsqueda","data-kt-search-element","input",1,"form-control","custom-form-control","ps-13",3,"input"],[1,"d-flex","align-items-center","gap-3"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2"],[1,"row"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"card","mb-4",2,"width","18rem"],[1,"position-relative"],[1,"card-img-top",3,"src","alt"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["type","button",1,"btn","btn-primary","btn-lg","w-100","d-flex","justify-content-center","align-items-center",3,"click"],[1,"ki-duotone","ki-handcart","text-white","me-2"]],template:function(i,a){i&1&&(e(0,"app-header"),G(1,0),e(2,"h1",1)(3,"span",2),o(4,"Paquetes"),t()(),R(),t(),e(5,"div",3)(6,"div",4)(7,"div",5)(8,"form",6),p(9,"input",7),e(10,"i",8),p(11,"span",9)(12,"span",10),t(),e(13,"input",11),u("input",function(){return a.onFilterTextBoxChanged()}),t()(),e(14,"div",12)(15,"button",13),u("click",function(){return a.loadTabla()}),e(16,"span",14),p(17,"span",15),e(18,"span",16),o(19,"Actualizar"),t()()()()(),e(20,"div",17),_(21,me,19,6,"div",18),f(22,"async"),t()()()),i&2&&(r(21),g("ngForOf",h(22,1,a.paquetesList)))},dependencies:[E,H,x,ee]}),d);oe=y([k()],oe);export{oe as a};
