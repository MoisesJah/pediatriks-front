import{a as X,b as at}from"./chunk-O3YCT3LC.js";import{a as W}from"./chunk-MISMYG7G.js";import{a as nt}from"./chunk-RIN4FRUE.js";import{a as ot}from"./chunk-X2SOKOUX.js";import{a as be}from"./chunk-UXZ2VA4W.js";import{a as ve}from"./chunk-TS646TIG.js";import{a as fe,b as he,c as Q,d as Y}from"./chunk-4FIJZXK5.js";import{a as J,b as K}from"./chunk-TJFBSUUK.js";import"./chunk-GT4JH6HJ.js";import"./chunk-EBZKSOFQ.js";import{b as et}from"./chunk-7KNNJSCE.js";import"./chunk-FMZGRIZ6.js";import{n as ie,o as M,p as $e,q as Qe,r as Ye,s as We,t as Je,u as Ke,v as Xe,w as Ze}from"./chunk-KLLKZ3UM.js";import{A as $,c as q,d as v,e as G,f as j,k as U,o as H,r as z,y as T}from"./chunk-MGQU4BYR.js";import{a as re}from"./chunk-UZO5QNZS.js";import{c as tt,d as it}from"./chunk-XKOQY6PJ.js";import{a as ge}from"./chunk-U2EAJGNN.js";import{a as k}from"./chunk-RQ4VGEOD.js";import{a as F,b as h}from"./chunk-PIACHCSP.js";import{a as ue}from"./chunk-J6P2CT7J.js";import{a as De}from"./chunk-GKZUPR7X.js";import{b as ze}from"./chunk-APQUY7ND.js";import{m as R,o as I,t as x,w as E}from"./chunk-JS4ZJV2L.js";import{Ba as _,Bc as ne,C as y,Cc as oe,Dc as ae,Ec as He,Fc as a,Gc as te,La as w,Ma as L,Mb as g,Oc as C,Qb as pe,Qc as ce,Sb as de,Ua as A,Vb as m,Vc as u,Wc as f,a as se,b as le,f as me,fc as o,gc as n,hc as s,ic as je,jc as Ue,lc as O,n as S,qa as qe,uc as c,v as D,vc as N,w as V,wa as Ge,wb as l,xa as d,xb as B}from"./chunk-B762IU3Y.js";var Z=(()=>{class r{constructor(t){this.http=t,this.apiUrl=`${De.apiUrl}/personal-permiso`,this.permisoUrl=`${De.apiUrl}/tipo-permiso`}getAll(){return this.http.get(`${this.apiUrl}/list`)}tipoPermisos(){return this.http.get(`${this.permisoUrl}/list`)}getById(t){return this.http.get(`${this.apiUrl}/list/${t}`)}create(t){return this.http.post(`${this.apiUrl}/add`,t)}update(t,i){return this.http.put(`${this.apiUrl}/edit/${t}`,i)}delete(t){return this.http.delete(`${this.apiUrl}/delete/${t}`)}static{this.\u0275fac=function(i){return new(i||r)(Ge(ze))}}static{this.\u0275prov=qe({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var rt=me(be());var mt=["end_date"];function pt(r,e){r&1&&s(0,"span",26)}var _e=class we{updateEndDatePicker(e){let t=this.endDateInput.nativeElement._flatpickr;if(t){t.set("minDate",e);let i=this.form.get("fecha_fin")?.value;i&&new Date(i)<e&&(this.form.get("fecha_fin")?.reset(),t.clear())}}startDateChange(e){let{selectedDates:t}=e;this.updateEndDatePicker(t[0])}constructor(e){this.fb=e,this.modal=d(M),this.permisoService=d(Z),this.personalService=d(W),this.isLoading=d(k).isLoading,this.onSaveComplete=new A,this.optionsInicio={locale:rt.Spanish,altFormat:"d/m/Y",altInput:!0,monthSelectorType:"dropdown",minDate:new Date},this.optionsFin=le(se({},this.optionsInicio),{minDate:new Date}),this.personalList=new S,this.tipoPermisoList=new S,this.form=this.fb.group({fecha_inicio:["",v.required],fecha_fin:["",v.required],notas:[""],id_personal:[null,v.required],id_permiso:[null,v.required]})}ngOnInit(){this.getPersonalList(),this.gettipoPermisoList()}ngAfterViewInit(){}close(){this.modal.dismissAll()}getPersonalList(){this.personalList=this.personalService.getAll().pipe(y(e=>e.data),h(this))}gettipoPermisoList(){this.tipoPermisoList=this.permisoService.tipoPermisos().pipe(y(e=>e.data),h(this))}crearPermiso(){this.form.valid&&this.permisoService.create(this.form.value).pipe(h(this)).subscribe({next:()=>{this.onSaveComplete.emit(),this.close()},error:e=>{console.log(e)}})}static{this.\u0275fac=function(t){return new(t||we)(B(T))}}static{this.\u0275cmp=_({type:we,selectors:[["app-create-permiso"]],viewQuery:function(t,i){if(t&1&&ne(mt,5),t&2){let p;oe(p=ae())&&(i.endDateInput=p.first)}},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[C],decls:48,vars:23,consts:[["end_date",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-add-files","text-gray-900","fs-1",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"formGroup"],[1,"form-group"],["for","status",1,"form-label","required"],["bindValue","id_personal","placeholder","Seleccionar","bindLabel","nombre","formControlName","id_personal",3,"items","loading","loadingText"],[1,"form-group","row"],[1,"col-6"],["placeholder","Seleccionar","type","date","mwlFlatpickr","","formControlName","fecha_inicio",1,"form-control",3,"flatpickrChange","options"],["type","date","placeholder","Seleccionar","mwlFlatpickr","","id","end_date","formControlName","fecha_fin",1,"form-control",3,"options"],["bindValue","id","placeholder","Seleccionar","bindLabel","nombre","formControlName","id_permiso",3,"items","loading","loadingText"],["for","status",1,"form-label"],["id","exampleFormControlTextarea1","rows","2","formControlName","notas",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(t,i){if(t&1){let p=O();o(0,"div",1)(1,"h4",2)(2,"span",3)(3,"i",4),s(4,"span",5)(5,"span",6)(6,"span",7),n()(),a(7," Crear Permiso "),n(),o(8,"button",8),c("click",function(){return w(p),L(i.close())}),o(9,"i",9),s(10,"span",5)(11,"span",6),n()()(),o(12,"div",10)(13,"form",11)(14,"div",12)(15,"label",13),a(16,"Seleccionar Personal"),n(),s(17,"ng-select",14),u(18,"async"),u(19,"async"),n(),o(20,"div",15)(21,"div",16)(22,"label",13),a(23,"Fecha de Inicio"),n(),o(24,"input",17),c("flatpickrChange",function(ke){return w(p),L(i.startDateChange(ke))}),n()(),o(25,"div",16)(26,"label",13),a(27,"Fecha de Fin"),n(),s(28,"input",18,0),n()(),o(30,"div",12)(31,"label",13),a(32,"Tipo de Permiso"),n(),s(33,"ng-select",19),u(34,"async"),u(35,"async"),n(),o(36,"div")(37,"label",20),a(38,"Observaciones"),n(),s(39,"textarea",21),n()()(),o(40,"div",22)(41,"button",23),c("click",function(){return w(p),L(i.close())}),a(42,"Cerrar"),n(),o(43,"button",24),u(44,"async"),c("click",function(){return w(p),L(i.crearPermiso())}),a(45,"Guardar "),g(46,pt,1,0,"span",25),u(47,"async"),n()()}t&2&&(l(13),m("formGroup",i.form),l(4),m("items",f(18,11,i.personalList))("loading",f(19,13,i.isLoading))("loadingText","Cargando..."),l(7),m("options",i.optionsInicio),l(4),m("options",i.optionsFin),l(5),m("items",f(34,15,i.tipoPermisoList))("loading",f(35,17,i.isLoading))("loadingText","Cargando..."),l(10),m("disabled",i.form.invalid||f(44,19,i.isLoading)),l(3),m("ngIf",f(47,21,i.isLoading)))},dependencies:[E,I,x,Y,Q,K,J,$,U,q,G,j,H,z],encapsulation:2})}};_e=D([F(),V("design:paramtypes",[T])],_e);var st=me(be());var dt=["start_date"],ct=["end_date"];function ut(r,e){r&1&&s(0,"span",27)}var Ce=class Ae{updateEndDatePicker(e){let t=this.endDateInput.nativeElement._flatpickr;if(t){t.set("minDate",e);let i=this.form.get("fecha_fin")?.value;i&&new Date(i)<e&&(this.form.get("fecha_fin")?.reset(),t.clear())}}startDateChange(e){let{selectedDates:t}=e;this.updateEndDatePicker(t[0])}constructor(e){this.fb=e,this.modal=d(M),this.permisoService=d(Z),this.personalService=d(W),this.isLoading=d(k).isLoading,this.onSaveComplete=new A,this.optionsInicio={locale:st.Spanish,altFormat:"d/m/Y",altInput:!0,minDate:new Date().toISOString().split("T")[0],monthSelectorType:"dropdown"},this.optionsFin=le(se({},this.optionsInicio),{minDate:new Date}),this.personalList=new S,this.tipoPermisoList=new S,this.form=this.fb.group({fecha_inicio:["",v.required],fecha_fin:["",v.required],notas:[""],id_personal:[null,v.required],id_permiso:[null,v.required]})}ngOnInit(){this.getPersonalList(),this.getPermiso(),this.gettipoPermisoList()}getPermiso(){this.permisoService.getById(this.permisoId).pipe(y(e=>e.data),h(this)).subscribe(e=>{this.form.patchValue({fecha_inicio:e.fecha_inicio,fecha_fin:e.fecha_fin,notas:e.notas,id_personal:e.id_personal,id_permiso:e.id_permiso})})}ngAfterViewInit(){}close(){this.modal.dismissAll()}getPersonalList(){this.personalList=this.personalService.getAll().pipe(y(e=>e.data),h(this))}gettipoPermisoList(){this.tipoPermisoList=this.permisoService.tipoPermisos().pipe(y(e=>e.data),h(this))}crearPermiso(){this.form.valid&&this.permisoService.update(this.permisoId,this.form.value).pipe(h(this)).subscribe({next:()=>{this.onSaveComplete.emit(),this.close()},error:e=>{console.log(e)}})}static{this.\u0275fac=function(t){return new(t||Ae)(B(T))}}static{this.\u0275cmp=_({type:Ae,selectors:[["app-edit-modal"]],viewQuery:function(t,i){if(t&1&&(ne(dt,5),ne(ct,5)),t&2){let p;oe(p=ae())&&(i.startDate=p.first),oe(p=ae())&&(i.endDateInput=p.first)}},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[C],decls:49,vars:23,consts:[["start_date",""],["end_date",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-add-files","text-gray-900","fs-1",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"formGroup"],[1,"form-group"],["for","status",1,"form-label","required"],["bindValue","id_personal","placeholder","Seleccionar","bindLabel","nombre","formControlName","id_personal",3,"items","loading","loadingText"],[1,"form-group","row"],[1,"col-6"],["placeholder","Seleccionar","type","date","mwlFlatpickr","","formControlName","fecha_inicio",1,"form-control",3,"flatpickrChange","options"],["type","date","placeholder","Seleccionar","mwlFlatpickr","","formControlName","fecha_fin",1,"form-control",3,"options"],["bindValue","id","placeholder","Seleccionar","bindLabel","nombre","formControlName","id_permiso",3,"items","loading","loadingText"],["for","status",1,"form-label"],["id","exampleFormControlTextarea1","rows","2","formControlName","notas",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(t,i){if(t&1){let p=O();o(0,"div",2)(1,"h4",3)(2,"span",4)(3,"i",5),s(4,"span",6)(5,"span",7)(6,"span",8),n()(),a(7," Editar Permiso "),n(),o(8,"button",9),c("click",function(){return w(p),L(i.close())}),o(9,"i",10),s(10,"span",6)(11,"span",7),n()()(),o(12,"div",11)(13,"form",12)(14,"div",13)(15,"label",14),a(16,"Seleccionar Personal"),n(),s(17,"ng-select",15),u(18,"async"),u(19,"async"),n(),o(20,"div",16)(21,"div",17)(22,"label",14),a(23,"Fecha de Inicio"),n(),o(24,"input",18,0),c("flatpickrChange",function(ke){return w(p),L(i.startDateChange(ke))}),n()(),o(26,"div",17)(27,"label",14),a(28,"Fecha de Fin"),n(),s(29,"input",19,1),n()(),o(31,"div",13)(32,"label",14),a(33,"Tipo de Permiso"),n(),s(34,"ng-select",20),u(35,"async"),u(36,"async"),n(),o(37,"div")(38,"label",21),a(39,"Observaciones"),n(),s(40,"textarea",22),n()()(),o(41,"div",23)(42,"button",24),c("click",function(){return w(p),L(i.close())}),a(43,"Cerrar"),n(),o(44,"button",25),u(45,"async"),c("click",function(){return w(p),L(i.crearPermiso())}),a(46,"Guardar "),g(47,ut,1,0,"span",26),u(48,"async"),n()()}t&2&&(l(13),m("formGroup",i.form),l(4),m("items",f(18,11,i.personalList))("loading",f(19,13,i.isLoading))("loadingText","Cargando..."),l(7),m("options",i.optionsInicio),l(5),m("options",i.optionsFin),l(5),m("items",f(35,15,i.tipoPermisoList))("loading",f(36,17,i.isLoading))("loadingText","Cargando..."),l(10),m("disabled",i.form.invalid||f(45,19,i.isLoading)),l(3),m("ngIf",f(48,21,i.isLoading)))},dependencies:[E,I,x,Y,Q,K,J,$,U,q,G,j,H,z],encapsulation:2})}};Ce=D([F(),V("design:paramtypes",[T])],Ce);function ft(r,e){r&1&&s(0,"span",13)}var lt=(()=>{class r{constructor(){this.modal=d(ie),this.permisoPersonalService=d(Z),this.isLoading=d(k).isLoading,this.onSaveComplete=new A}close(){this.modal.dismiss()}delete(){this.permisoPersonalService.delete(this.permisoId).subscribe({next:()=>{this.onSaveComplete.emit(),this.modal.close()},error:t=>{console.log(t)}})}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=_({type:r,selectors:[["app-delete-modal"]],outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[C],decls:23,vars:6,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-information","text-danger","fs-2hx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body","text-center"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(i,p){i&1&&(o(0,"div",0)(1,"h4",1)(2,"span")(3,"i",2),s(4,"span",3)(5,"span",4)(6,"span",5),n()(),a(7," Eliminar Permiso "),n(),o(8,"button",6),c("click",function(){return p.close()}),o(9,"i",7),s(10,"span",3)(11,"span",4),n()()(),o(12,"div",8)(13,"p"),a(14,"\xBFEst\xE1s seguro de eliminar este registro?"),n()(),o(15,"div",9)(16,"button",10),c("click",function(){return p.close()}),a(17," Cancelar "),n(),o(18,"button",11),u(19,"async"),c("click",function(){return p.delete()}),a(20," Eliminar "),g(21,ft,1,0,"span",12),u(22,"async"),n()()),i&2&&(l(18),m("disabled",f(19,2,p.isLoading)),l(3),m("ngIf",f(22,4,p.isLoading)))},dependencies:[E,I,x],encapsulation:2})}}return r})();var ht=()=>[import("./chunk-I4BRQATP.js").then(r=>r.AgGridAngular),x],gt=r=>[r];function bt(r,e){if(r&1){let t=O();o(0,"ag-grid-angular",18),u(1,"async"),u(2,"async"),c("gridReady",function(p){w(t);let b=N();return L(b.onGridReady(p))}),n()}if(r&2){let t=N();m("rowData",f(1,7,t.permisosList))("columnDefs",t.colDefs)("loading",f(2,9,t.isLoading))("localeText",t.localeText)("enableCellTextSelection",!0)("ariaHidden",!0)("pagination",!0)}}function vt(r,e){r&1&&(o(0,"div",19)(1,"div",20)(2,"span",21),a(3,"Loading..."),n()()())}var Se=class Ie{constructor(){this.permisoService=d(Z),this.modal=d(M),this.isLoading=d(k).isLoading,this.theme=d(ue),this.localeText=ge,this.permisosList=new S,this.colDefs=[{field:"personal.nombre",headerName:"Terapista",filter:!0},{field:"personal.terapia.nombre",headerName:"Terapia",filter:!0},{field:"fecha_inicio",headerName:"Fecha Inicio",filter:"agDateColumnFilter",valueFormatter:e=>re(e.value)},{field:"fecha_fin",headerName:"Fecha Fin",filter:"agDateColumnFilter",valueFormatter:e=>re(e.value)},{field:"permiso.nombre",headerName:"Tipo de Permiso",minWidth:250,cellRenderer:e=>`<span class="badge badge-light-primary rounded-pill fs-7">${e.data.permiso.nombre}</span>`,filter:!0},{field:"notas",headerName:"Observaciones",wrapText:!1,filter:!0},{headerName:"Acciones",cellRenderer:nt,cellRendererParams:{onEdit:e=>this.openEditModal(e),onDelete:e=>this.openDeleteModal(e)},maxWidth:100,resizable:!1}]}ngOnInit(){this.loadPermisos()}loadPermisos(){this.permisosList=this.permisoService.getAll().pipe(y(e=>e.data),h(this))}loadTabla(){this.loadPermisos()}onGridReady(e){this.gridApi=e.api}onFilterTextBoxChanged(){this.gridApi.setGridOption("quickFilterText",document.getElementById("asistencia-search").value)}close(){this.modal.dismissAll()}openCreateModal(){this.modal.open(_e,{centered:!0}).componentInstance.onSaveComplete.subscribe(()=>{this.loadTabla()})}openDeleteModal(e){let t=this.modal.open(lt,{centered:!0,backdrop:"static"});t.componentInstance.permisoId=e.id,t.componentInstance.onSaveComplete.subscribe(()=>{this.loadTabla()})}openEditModal(e){let t=this.modal.open(Ce,{centered:!0,backdrop:"static"});t.componentInstance.permisoId=e.id,t.componentInstance.onSaveComplete.subscribe(()=>{this.loadTabla()})}static{this.\u0275fac=function(t){return new(t||Ie)}}static{this.\u0275cmp=_({type:Ie,selectors:[["app-tabla-permisos"]],standalone:!0,features:[C],decls:25,vars:3,consts:[[1,"container-xxl"],[1,"card","shadow","p-2","px-4"],[1,"d-flex","py-4","gap-3","justify-content-between"],["data-kt-search-element","form","autocomplete","off",1,"position-relative"],["type","hidden"],[1,"ki-duotone","ki-magnifier","fs-2","search-icon","position-absolute","top-50","translate-middle-y","ms-4"],[1,"path1"],[1,"path2"],["type","search","id","asistencia-search","name","search","value","","placeholder","B\xFAsqueda","data-kt-search-element","input",1,"form-control","custom-form-control","ps-13",3,"input"],[1,"d-flex","align-items-stretch","gap-3"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2","d-none","d-md-block"],["type","button",1,"btn","btn-primary",3,"click"],[1,"ki-solid","ki-plus","text-white","fs-1"],[1,"text-white","ms-2"],[2,"height","calc(100dvh - 281px)",3,"ngClass"],["loadingMessage","Cargando...",2,"width","100%","height","100%",3,"gridReady","rowData","columnDefs","loading","localeText","enableCellTextSelection","ariaHidden","pagination"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100%"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),s(4,"input",4),o(5,"i",5),s(6,"span",6)(7,"span",7),n(),o(8,"input",8),c("input",function(){return i.onFilterTextBoxChanged()}),n()(),o(9,"div",9)(10,"button",10),c("click",function(){return i.loadTabla()}),o(11,"span",11),s(12,"span",12),o(13,"span",13),a(14,"Actualizar"),n()()(),o(15,"button",14),c("click",function(){return i.openCreateModal()}),o(16,"span",11),s(17,"span",15),o(18,"span",16),a(19,"A\xF1adir"),n()()()()(),o(20,"div",17),g(21,bt,3,11)(22,vt,4,0),pe(23,21,ht,22),de(),n()()()),t&2&&(l(20),m("ngClass",ce(1,gt,i.theme.getThemeMode()==="light"?"ag-theme-quartz":"ag-theme-quartz-dark")))},dependencies:[E,R],encapsulation:2})}};Se=D([F()],Se);var Me=me(be());function _t(r,e){if(r&1&&(o(0,"div",14)(1,"label",11),a(2,"Hora de Asistencia"),n(),s(3,"input",25,0),n()),r&2){let t=N();l(3),m("options",t.optionsHora)}}function Ct(r,e){if(r&1&&(o(0,"div",26),s(1,"span",27),o(2,"span",28),a(3),n()()),r&2){let t=e.item,i=N();l(),m("ngClass",i.getIcon(t.nombre)),l(2),te(t.nombre)}}function St(r,e){if(r&1&&(o(0,"div",26),s(1,"span",27),o(2,"span",28),a(3),n()()),r&2){let t=e.item,i=N();l(),m("ngClass",i.getIcon(t.nombre)),l(2),te(t.nombre)}}var ye=class Pe{constructor(e){this.fb=e,this.modal=d(M),this.isLoading=d(k).isLoading,this.asistenciaService=d(X),this.personalService=d(W),this.toast=d(ve),this.id_asistencia="",this.onSaveComplete=new A,this.statusList=new S,this.personalList=new S,this.optionsFecha={locale:Me.Spanish,altFormat:"d/m/Y",altInput:!0,monthSelectorType:"dropdown",minDate:new Date().toISOString().split("T")[0]},this.isInasistencia=!1,this.optionsHora={locale:Me.Spanish,enableTime:!0,noCalendar:!0,dateFormat:"H:i",minuteIncrement:1,minTime:"08:00",defaultHour:8,maxTime:"20:00"},this.form=this.fb.group({id_personal:[null,v.required],id_status:[null,v.required],fecha:["",v.required],hora_asistencia:[""],observaciones:[""]})}statusChange(e){this.isInasistencia=e.nombre==="inasistencia";let t=this.form.get("hora_asistencia");this.isInasistencia?t?.reset():t?.setValidators(v.required),t?.updateValueAndValidity()}getRecord(){this.asistenciaService.getById(this.id_asistencia).pipe(y(e=>e.data),h(this)).subscribe(e=>{this.form.patchValue(e)})}getPersonalList(){this.personalList=this.personalService.getAll().pipe(y(e=>e.data),h(this))}getIcon(e){switch(e){case"asisti\xF3":return"h-10px w-10px bg-success rounded-pill";case"tardanza":return"h-10px w-10px bg-warning rounded-pill";case"inasistencia":return"h-10px w-10px bg-danger rounded-pill";case"justificado":return"h-10px w-10px bg-primary bg-opacity-75 rounded-pill";default:return""}}ngOnInit(){this.getStatusList(),this.getRecord(),this.getPersonalList()}close(){this.modal.dismissAll()}update(){this.form.valid&&this.asistenciaService.update(this.form.value,this.id_asistencia).pipe(h(this)).subscribe({next:e=>{this.onSaveComplete.emit(),this.close()},error:e=>{if(e.error.errors){let t=Object.values(e.error.errors).join(`
`);this.toast.error(t,"Error")}else this.toast.error("Ocurrio un error al actualizar la asistencia","Error")}})}getStatusList(){this.statusList=this.asistenciaService.getStatusList().pipe(h(this))}static{this.\u0275fac=function(t){return new(t||Pe)(B(T))}}static{this.\u0275cmp=_({type:Pe,selectors:[["app-edit-status"]],outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[C],decls:43,vars:20,consts:[["end_date",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-notepad-edit","text-gray-900","fs-1",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"d-flex","flex-column","gap-4",3,"formGroup"],[1,"form-group"],["for","status",1,"form-label","required"],["bindValue","id_personal","placeholder","Seleccionar","bindLabel","nombre","formControlName","id_personal",3,"items","loading","loadingText"],[1,"form-group","row"],[1,"col-6"],["placeholder","Seleccionar","type","date","mwlFlatpickr","","formControlName","fecha",1,"form-control",3,"options"],["class","col-6",4,"ngIf"],["bindValue","id","placeholder","Seleccionar","bindLabel","nombre","formControlName","id_status",3,"change","items","loading","loadingText"],["ng-option-tmp",""],["ng-label-tmp",""],["for","observaciones",1,"form-label"],["formControlName","observaciones","id","observaciones","rows","3",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["type","date","placeholder","Seleccionar","mwlFlatpickr","","id","end_date","formControlName","hora_asistencia",1,"form-control",3,"options"],[1,"d-flex","align-items-center","gap-2"],[3,"ngClass"],[1,"fw-medium","text-capitalize"]],template:function(t,i){t&1&&(o(0,"div",1)(1,"h4",2)(2,"span")(3,"i",3),s(4,"span",4)(5,"span",5),n()(),a(6," Actualizar Status "),n(),o(7,"button",6),c("click",function(){return i.close()}),o(8,"i",7),s(9,"span",4)(10,"span",5),n()()(),o(11,"div",8)(12,"form",9)(13,"div",10)(14,"label",11),a(15,"Seleccionar Personal"),n(),s(16,"ng-select",12),u(17,"async"),u(18,"async"),n(),o(19,"div",13)(20,"div",14)(21,"label",11),a(22,"Fecha"),n(),s(23,"input",15),n(),g(24,_t,5,1,"div",16),n(),o(25,"div",10)(26,"label",11),a(27,"Status"),n(),o(28,"ng-select",17),u(29,"async"),u(30,"async"),c("change",function(b){return i.statusChange(b)}),g(31,Ct,4,2,"ng-template",18)(32,St,4,2,"ng-template",19),n()(),o(33,"div",10)(34,"label",20),a(35,"Notas:"),n(),s(36,"textarea",21),n()()(),o(37,"div",22)(38,"button",23),c("click",function(){return i.close()}),a(39,"Cerrar"),n(),o(40,"button",24),u(41,"async"),c("click",function(){return i.update()}),a(42,"Guardar "),n()()),t&2&&(l(12),m("formGroup",i.form),l(4),m("items",f(17,10,i.personalList))("loading",f(18,12,i.isLoading))("loadingText","Cargando..."),l(7),m("options",i.optionsFecha),l(),m("ngIf",!i.isInasistencia),l(4),m("items",f(29,14,i.statusList))("loading",f(30,16,i.isLoading))("loadingText","Cargando..."),l(12),m("disabled",i.form.invalid||f(41,18,i.isLoading)))},dependencies:[E,R,I,x,$,U,q,G,j,H,z,Y,Q,fe,he,K,J],encapsulation:2})}};ye=D([F(),V("design:paramtypes",[T])],ye);var Ve=me(be());function yt(r,e){if(r&1&&(o(0,"div",16)(1,"label",13),a(2,"Hora de Asistencia"),n(),s(3,"input",27,0),n()),r&2){let t=N();l(3),m("options",t.optionsHora)}}function xt(r,e){if(r&1&&(o(0,"div",28),s(1,"span",29),o(2,"span",30),a(3),n()()),r&2){let t=e.item,i=N();l(),m("ngClass",i.getIcon(t.nombre)),l(2),te(t.nombre)}}function Et(r,e){if(r&1&&(o(0,"div",28),s(1,"span",29),o(2,"span",30),a(3),n()()),r&2){let t=e.item,i=N();l(),m("ngClass",i.getIcon(t.nombre)),l(2),te(t.nombre)}}var xe=class Be{close(){this.modal.close()}constructor(e){this.fb=e,this.modal=d(ie),this.asistenciaService=d(X),this.isLoading=d(k).isLoading,this.personalService=d(W),this.toast=d(ve),this.onSaveComplete=new A,this.optionsFecha={locale:Ve.Spanish,altFormat:"d/m/Y",altInput:!0,monthSelectorType:"dropdown",minDate:new Date},this.isInasistencia=!1,this.optionsHora={locale:Ve.Spanish,enableTime:!0,noCalendar:!0,dateFormat:"H:i",minuteIncrement:1,minTime:"08:00",defaultHour:8,maxTime:"20:00"},this.personalList=new S,this.statusList=new S,this.form=this.fb.group({id_personal:[null,v.required],id_status:[null,v.required],fecha:["",v.required],hora_asistencia:[""],observaciones:[""]})}ngOnInit(){this.getPersonalList(),this.getStatusList()}statusChange(e){console.log(e),this.isInasistencia=e.nombre==="inasistencia";let t=this.form.get("hora_asistencia");this.isInasistencia?t?.reset():t?.setValidators(v.required),t?.updateValueAndValidity()}getPersonalList(){this.personalList=this.personalService.getAll().pipe(y(e=>e.data),h(this))}getIcon(e){switch(e){case"asisti\xF3":return"h-10px w-10px bg-success rounded-pill";case"tardanza":return"h-10px w-10px bg-warning rounded-pill";case"inasistencia":return"h-10px w-10px bg-danger rounded-pill";case"justificado":return"h-10px w-10px bg-primary bg-opacity-75 rounded-pill";default:return""}}getStatusList(){this.statusList=this.asistenciaService.getStatusList().pipe(h(this))}create(){this.form.valid&&this.asistenciaService.create(this.form.value).pipe(h(this)).subscribe({next:()=>{this.onSaveComplete.emit(),this.close()},error:e=>{if(e.error.errors){let t=Object.values(e.error.errors).join(`
`);this.toast.error(t,"Error")}else this.toast.error("Ocurrio un error al crear la asistencia","Error")}})}static{this.\u0275fac=function(t){return new(t||Be)(B(T))}}static{this.\u0275cmp=_({type:Be,selectors:[["app-create-asistencia"]],outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[C],decls:44,vars:20,consts:[["end_date",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-add-files","text-gray-900","fs-1",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"formGroup"],[1,"form-group"],["for","status",1,"form-label","required"],["bindValue","id_personal","placeholder","Seleccionar","bindLabel","nombre","formControlName","id_personal",3,"items","loading","loadingText"],[1,"form-group","row"],[1,"col-6"],["placeholder","Seleccionar","type","date","mwlFlatpickr","","formControlName","fecha",1,"form-control",3,"options"],["class","col-6",4,"ngIf"],["bindValue","id","placeholder","Seleccionar","bindLabel","nombre","formControlName","id_status",3,"change","items","loading","loadingText"],["ng-option-tmp",""],["ng-label-tmp",""],["for","status",1,"form-label"],["id","exampleFormControlTextarea1","rows","2","formControlName","observaciones",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["type","date","placeholder","Seleccionar","mwlFlatpickr","","id","end_date","formControlName","hora_asistencia",1,"form-control",3,"options"],[1,"d-flex","align-items-center","gap-2"],[3,"ngClass"],[1,"fw-medium","text-capitalize"]],template:function(t,i){t&1&&(o(0,"div",1)(1,"h4",2)(2,"span",3)(3,"i",4),s(4,"span",5)(5,"span",6)(6,"span",7),n()(),a(7," Crear Asistencia "),n(),o(8,"button",8),c("click",function(){return i.close()}),o(9,"i",9),s(10,"span",5)(11,"span",6),n()()(),o(12,"div",10)(13,"form",11)(14,"div",12)(15,"label",13),a(16,"Seleccionar Personal"),n(),s(17,"ng-select",14),u(18,"async"),u(19,"async"),n(),o(20,"div",15)(21,"div",16)(22,"label",13),a(23,"Fecha"),n(),s(24,"input",17),n(),g(25,yt,5,1,"div",18),n(),o(26,"div",12)(27,"label",13),a(28,"Status"),n(),o(29,"ng-select",19),u(30,"async"),u(31,"async"),c("change",function(b){return i.statusChange(b)}),g(32,xt,4,2,"ng-template",20)(33,Et,4,2,"ng-template",21),n()(),o(34,"div")(35,"label",22),a(36,"Observaciones"),n(),s(37,"textarea",23),n()()(),o(38,"div",24)(39,"button",25),c("click",function(){return i.close()}),a(40,"Cerrar"),n(),o(41,"button",26),u(42,"async"),c("click",function(){return i.create()}),a(43,"Guardar "),n()()),t&2&&(l(13),m("formGroup",i.form),l(4),m("items",f(18,10,i.personalList))("loading",f(19,12,i.isLoading))("loadingText","Cargando..."),l(7),m("options",i.optionsFecha),l(),m("ngIf",!i.isInasistencia),l(4),m("items",f(30,14,i.statusList))("loading",f(31,16,i.isLoading))("loadingText","Cargando..."),l(12),m("disabled",i.form.invalid||f(42,18,i.isLoading)))},dependencies:[E,R,I,x,$,U,q,G,j,H,z,Y,Q,fe,he,K,J],encapsulation:2})}};xe=D([F(),V("design:paramtypes",[T])],xe);function Tt(r,e){r&1&&s(0,"span",14)}var Ee=class Oe{constructor(){this.modal=d(ie),this.asistenciaService=d(X),this.isLoading=d(k).isLoading,this.onSaveComplete=new A}close(){this.modal.dismiss()}delete(){this.asistenciaService.delete(this.id_asistencia).pipe(h(this)).subscribe(()=>{this.onSaveComplete.emit(),this.modal.close()})}static{this.\u0275fac=function(t){return new(t||Oe)}}static{this.\u0275cmp=_({type:Oe,selectors:[["app-delete-asistencia"]],outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[C],decls:23,vars:6,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-information","text-danger","fs-2hx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body","text-center"],[1,"fs-6"],[1,"modal-footer"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],["type","button",1,"btn","btn-sm","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"h4",1)(2,"span")(3,"i",2),s(4,"span",3)(5,"span",4)(6,"span",5),n()(),a(7," Eliminar Asistencia "),n(),o(8,"button",6),c("click",function(){return i.close()}),o(9,"i",7),s(10,"span",3)(11,"span",4),n()()(),o(12,"div",8)(13,"p",9),a(14,"\xBFEst\xE1s seguro de eliminar este registro?"),n()(),o(15,"div",10)(16,"button",11),c("click",function(){return i.close()}),a(17," Cancelar "),n(),o(18,"button",12),u(19,"async"),c("click",function(){return i.delete()}),a(20," Eliminar "),g(21,Tt,1,0,"span",13),u(22,"async"),n()()),t&2&&(l(18),m("disabled",f(19,2,i.isLoading)),l(3),m("ngIf",f(22,4,i.isLoading)))},dependencies:[E,I,x],encapsulation:2})}};Ee=D([F()],Ee);var kt=()=>[x,tt],Dt=r=>[r];function wt(r,e){if(r&1){let t=O();o(0,"ag-grid-angular",18),u(1,"async"),u(2,"async"),c("gridReady",function(p){w(t);let b=N();return L(b.onGridReady(p))}),n()}if(r&2){let t=N();m("rowData",f(1,7,t.asistenciaList))("columnDefs",t.colDefs)("loading",f(2,9,t.isLoading))("localeText",t.localeText)("enableCellTextSelection",!0)("ariaHidden",!0)("pagination",!0)}}function Lt(r,e){r&1&&(o(0,"div",19)(1,"div",20)(2,"span",21),a(3,"Loading..."),n()()())}var Te=class Re{constructor(){this.asistenciaService=d(X),this.isLoading=d(k).isLoading,this.theme=d(ue),this.modal=d(M),this.localeText=ge,this.asistenciaList=new S,this.colDefs=[{field:"personal.nombre",headerName:"Terapista",filter:!0},{field:"personal.terapia.nombre",headerName:"Terapia",filter:!0},{field:"fecha",headerName:"Fecha",filter:"agDateColumnFilter",valueFormatter:e=>re(e.value)},{field:"hora_asistencia",headerName:"Hora de Asistencia",filter:"agDateColumnFilter"},{field:"status.nombre",headerName:"Status",filter:!0,cellRenderer:at},{field:"observaciones",headerName:"Notas",filter:!0},{headerName:"Acciones",cellRenderer:ot,cellRendererParams:{onEdit:e=>this.openUpdateModal(e),onDelete:e=>this.openDeleteModal(e.id)},maxWidth:100,resizable:!1}]}ngOnInit(){this.loadAsistencias()}loadAsistencias(){this.asistenciaList=this.asistenciaService.getAll().pipe(y(e=>e.data),h(this))}loadTabla(){this.loadAsistencias()}onGridReady(e){this.gridApi=e.api}onFilterTextBoxChanged(){this.gridApi.setGridOption("quickFilterText",document.getElementById("asistencia-search").value)}openCreateModal(){this.modal.open(xe,{centered:!0}).componentInstance.onSaveComplete.subscribe(()=>{this.loadTabla()})}openUpdateModal(e){let t=this.modal.open(ye,{centered:!0,backdrop:"static"});t.componentInstance.id_asistencia=e.id,t.componentInstance.onSaveComplete.subscribe(()=>{this.loadTabla()})}openDeleteModal(e){let t=this.modal.open(Ee,{centered:!0,size:"sm",backdrop:"static"});t.componentInstance.id_asistencia=e,t.componentInstance.onSaveComplete.subscribe(()=>{this.loadTabla()})}static{this.\u0275fac=function(t){return new(t||Re)}}static{this.\u0275cmp=_({type:Re,selectors:[["app-asistencia"]],standalone:!0,features:[C],decls:25,vars:3,consts:[[1,"container-xxl"],[1,"card","shadow","p-2","px-4"],[1,"d-flex","py-4","gap-3","justify-content-between"],["data-kt-search-element","form","autocomplete","off",1,"position-relative"],["type","hidden"],[1,"ki-duotone","ki-magnifier","fs-2","search-icon","position-absolute","top-50","translate-middle-y","ms-4"],[1,"path1"],[1,"path2"],["type","search","id","asistencia-search","name","search","value","","placeholder","B\xFAsqueda","data-kt-search-element","input",1,"form-control","custom-form-control","ps-13",3,"input"],[1,"d-flex","align-items-stretch","gap-3"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2","d-none","d-md-block"],["type","button",1,"btn","btn-primary",3,"click"],[1,"ki-solid","ki-plus","text-white","fs-1"],[1,"text-white","ms-2"],[2,"height","calc(100dvh - 281px)",3,"ngClass"],["loadingMessage","Cargando...",2,"width","100%","height","100%",3,"gridReady","rowData","columnDefs","loading","localeText","enableCellTextSelection","ariaHidden","pagination"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100%"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),s(4,"input",4),o(5,"i",5),s(6,"span",6)(7,"span",7),n(),o(8,"input",8),c("input",function(){return i.onFilterTextBoxChanged()}),n()(),o(9,"div",9)(10,"button",10),c("click",function(){return i.loadTabla()}),o(11,"span",11),s(12,"span",12),o(13,"span",13),a(14,"Actualizar"),n()()(),o(15,"button",14),c("click",function(){return i.openCreateModal()}),o(16,"span",11),s(17,"span",15),o(18,"span",16),a(19,"A\xF1adir"),n()()()()(),o(20,"div",17),g(21,wt,3,11)(22,Lt,4,0),pe(23,21,kt,22),de(),n()()()),t&2&&(l(20),m("ngClass",ce(1,Dt,i.theme.getThemeMode()==="light"?"ag-theme-quartz":"ag-theme-quartz-dark")))},dependencies:[E,R,it]})}};Te=D([F()],Te);function Nt(r,e){r&1&&s(0,"app-asistencia")}function Ft(r,e){r&1&&s(0,"app-tabla-permisos")}var io=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=_({type:r,selectors:[["app-main-tabs"]],standalone:!0,features:[C],decls:18,vars:3,consts:[["nav","ngbNav"],["header-title",""],[1,"d-flex","flex-column","text-gray-900","fw-bold","my-1"],[1,"",2,"color","white"],[1,"content","bg-body","tabs-asistencia","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],["ngbNav","",1,"nav","nav-tabs","fw-medium","nav-line-tabs","nav-line-tabs-2x","fs-6"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"]],template:function(i,p){if(i&1&&(o(0,"app-header"),je(1,1),o(2,"h1",2)(3,"span",3),a(4,"Asistencias"),n()(),Ue(),n(),o(5,"div",4)(6,"div",5)(7,"ul",6,0)(9,"li",7)(10,"a",8),a(11,"Asistencia del Personal"),n(),g(12,Nt,1,0,"ng-template",9),n(),o(13,"li",7)(14,"a",8),a(15,"Permisos del Personal"),n(),g(16,Ft,1,0,"ng-template",9),n()()(),s(17,"div",10),n()),i&2){let b=He(8);l(9),m("ngbNavItem",1),l(4),m("ngbNavItem",2),l(4),m("ngbNavOutlet",b)}},dependencies:[Ze,$e,We,Ye,Qe,Ke,Je,Xe,Se,Te,et]})}}return r})();export{io as MainTabsComponent};
