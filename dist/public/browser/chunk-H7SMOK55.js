import{a as H,b as U,c as N,d as j,e as q}from"./chunk-ZJJN7SN5.js";import{a as u}from"./chunk-7YUY65AQ.js";import{ib as z,jb as Z,lb as K}from"./chunk-HSVI2AL3.js";import"./chunk-D5V43OAI.js";import{a as J}from"./chunk-VTU3SGCZ.js";import"./chunk-T5EURV5D.js";import{a as V}from"./chunk-3B2MPMJU.js";import"./chunk-QHO6RQLH.js";import"./chunk-SX6LGTBN.js";import"./chunk-FLXP5CLU.js";import"./chunk-C3PJ6G3N.js";import"./chunk-GT4JH6HJ.js";import"./chunk-EBZKSOFQ.js";import{b as R}from"./chunk-SMQXWYLW.js";import{o as A}from"./chunk-SZA4NEXD.js";import{a as B}from"./chunk-5ZMKPZZY.js";import{a as O}from"./chunk-3IC3XWDF.js";import{a as Q,b as p}from"./chunk-T3S5D2ZO.js";import"./chunk-H7V4WWIX.js";import"./chunk-GKZUPR7X.js";import{l as T}from"./chunk-DA7F7PFS.js";import{m as F,t as L,v as G}from"./chunk-IVHFDWNE.js";import{Ba as g,Bc as l,C as s,Jc as M,Lc as D,Mb as y,Qb as b,Qc as m,Rc as c,Tb as x,Vb as S,ec as r,fc as a,gc as k,hc as w,ic as _,ka as d,n as v,rc as P,v as C,xa as n,xc as W,yc as E,zc as I}from"./chunk-MKY54U27.js";var Y=["calendar"],$=()=>[z,F,L],ee=o=>({"opacity-50":o});function te(o,e){if(o&1&&(k(0,"full-calendar",8,0),m(2,"async"),m(3,"async")),o&2){let t=P();S("events",c(2,3,t.citasEvent))("ngClass",D(7,ee,c(3,5,t.isLoading)))("options",t.calendarOptions)}}function ie(o,e){o&1&&(r(0,"h1"),l(1,"Loading..."),a())}var X=class f{constructor(){this.isLoading=n(B).isLoading,this.modalService=n(A),this.loadingCalendar=!1,this.citasService=n(J),this.userService=n(O),this.personalService=n(V),this.router=n(T),this.citasEvent=new v,this.personalId="",this.startWeek=u().startOfWeek,this.endWeek=u().endOfWeek,this.calendarOptions={plugins:[H,U,N,j],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},eventMaxStack:1,allDaySlot:!1,expandRows:!0,slotLabelInterval:"00:05:00",slotMinTime:"08:00",slotMaxTime:"20:00:00",slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:!1,meridiem:"narrow"},eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},selectConstraint:"businessHours",initialView:"timeGridWeek",weekends:!0,editable:!0,loading:e=>{this.loadingCalendar=e},eventClick:this.handleEventClick.bind(this),selectAllow:e=>{let t=this.calendar?.getApi()?.view.type=="timeGridWeek",i=new Date;return i.setHours(0,0,0,0),e.start>=i&&t},selectable:!1,selectMirror:!0,dayMaxEvents:!0,locale:q,datesSet:e=>{this.startWeek=e.view.activeStart,this.endWeek=e.view.activeEnd,this.loadCitas(this.bodyParams)}}}ngOnInit(){this.getPersonalId()}get bodyParams(){return{id_personal:this.personalId,startWeek:this.startWeek,endWeek:this.endWeek}}getPersonalId(){this.personalService.getPersonalByUser(this.userService.user()?.id).pipe(s(e=>e.data.id_personal),d(e=>this.personalId=e),d(()=>this.loadCitas(this.bodyParams)),p(this)).subscribe()}loadCitas(e){if(this.personalId)return this.citasEvent=this.citasService.getByPersonal(e).pipe(s(t=>t.data),p(this))}handleEventClick(e){let t=e.event,i=this.modalService.open(K,{centered:!0,size:"100",scrollable:!0,backdrop:"static"});window.document.body.classList.add("modal-open"),i.componentInstance.eventId=t.id,i.componentInstance.citaId=t.extendedProps.id_cita,i.componentInstance.eventUpdated.subscribe(()=>{this.loadCitas(this.bodyParams)})}static{this.\u0275fac=function(t){return new(t||f)}}static{this.\u0275cmp=g({type:f,selectors:[["app-citas"]],viewQuery:function(t,i){if(t&1&&W(Y,5),t&2){let h;E(h=I())&&(i.calendar=h.first)}},standalone:!0,features:[M],decls:13,vars:0,consts:[["calendar",""],["header-title",""],[1,"d-flex","align-items-center","text-white","fw-bold","my-1"],[1,"content","d-flex","flex-column","flex-column-fluid"],["id","kt_content_container",1,"container-xxl"],[1,"card"],[1,"card-body",2,"border","none","box-shadow","0 4px 8px rgba(0, 0, 0, 0.1)","border-radius","0 0 15px 15px"],[1,"demo-app-main"],[3,"events","ngClass","options"]],template:function(t,i){t&1&&(r(0,"app-header"),w(1,1),r(2,"h1",2),l(3," Calendario de Citas "),a(),_(),a(),r(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),y(9,te,4,9)(10,ie,2,0),b(11,9,$,null,10),x(0,-1),a()()()()())},dependencies:[R,Z,G]})}};X=C([Q()],X);export{X as CitasComponent};
