import{a as se}from"./chunk-ELH37R5Z.js";import{a as T}from"./chunk-Q4VFHCA5.js";import{a as B}from"./chunk-GT4JH6HJ.js";import{a as de}from"./chunk-MYRVSVX3.js";import{a as le}from"./chunk-73QAVBZN.js";import{a as x}from"./chunk-C4LB5HPP.js";import{b as k,i as oe,j as ae}from"./chunk-FR665RP3.js";import{e as K,f as c,g as X,h as Y,l as Z,m as ee,o as te,r as ie,s as ne,u as re,w as F}from"./chunk-O36CONK3.js";import{e as J,g as M,j as y,l as E}from"./chunk-FM6AGUVW.js";import{B as R,Da as S,Ec as _,Gc as $,I as H,Kb as C,Kc as b,Lc as g,Na as N,Oa as I,Ob as O,Qb as j,Tb as f,Wa as D,ac as t,bc as e,cc as n,dc as z,ec as Q,gc as U,mc as m,nc as W,sc as q,t as V,tc as A,uc as L,wb as h,wc as r,xb as G,za as u}from"./chunk-6QDZBSPE.js";var be=["startTimePicker"],ge=["endTimePicker"];function ve(o,i){o&1&&n(0,"span",43)}var ce=(()=>{let i=class i{constructor(a){this.fb=a,this.modal=u(k),this.sedeService=u(T),this.loadingService=u(x),this.isLoading=this.loadingService.isLoading,this.onSaveComplete=new D,this.sedeForm=this.fb.group({nombre:["",c.required],direccion:["",c.required],distrito:["",c.required],provincia:["",c.required],departamento:["",c.required],telefono:["",[c.required,c.pattern("^[0-9]+$")]],email:["",[c.required,c.email]],horarioapertura:["",c.required],horariocierre:["",c.required],capacidadpacientes:["",[c.required,c.min(1)]],numeroconsultorios:["",[c.required,c.min(1)]]})}ngAfterViewInit(){this.startTimePicker&&this.startTimePicker.nativeElement&&B(this.startTimePicker.nativeElement,{enableTime:!0,noCalendar:!0,dateFormat:"H:i"}),this.endTimePicker&&this.endTimePicker.nativeElement&&B(this.endTimePicker.nativeElement,{enableTime:!0,noCalendar:!0,dateFormat:"H:i"})}close(){this.modal.dismissAll()}save(){this.sedeForm.valid&&(this.loadingService.setLoading(!0,"sede/create"),this.sedeService.create(this.sedeForm.value).subscribe({next:a=>{this.loadingService.setLoading(!1,"sede/create"),this.onSaveComplete.emit(),this.close()},error:a=>{console.error("Error al crear sede:",a),this.loadingService.setLoading(!1,"sede/create")}}))}onStartTimeChange(a){let[l,d]=a.target.value.split(":").map(Number),s=new Date;s.setHours(l,d+1),this.endTimePicker.nativeElement._flatpickr.set("minDate",s)}};i.\u0275fac=function(l){return new(l||i)(G(re))},i.\u0275cmp=S({type:i,selectors:[["app-crear-modal"]],viewQuery:function(l,d){if(l&1&&(q(be,5),q(ge,5)),l&2){let s;A(s=L())&&(d.startTimePicker=s.first),A(s=L())&&(d.endTimePicker=s.first)}},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[_],decls:73,vars:7,consts:[["startTimePicker",""],["endTimePicker",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-add-files","text-gray-900","fs-1",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"formGroup"],[1,"row"],[1,"form-group","col-6"],["for","nombre",1,"required","form-label"],["type","text","id","nombre","formControlName","nombre","placeholder","Ingresar Nombre de la Sede",1,"form-control"],["for","direccion",1,"required","form-label"],["type","text","id","direccion","formControlName","direccion","placeholder","Ingresar Direcci\xF3n de la Sede",1,"form-control"],["for","distrito",1,"required","form-label"],["type","text","id","distrito","formControlName","distrito","placeholder","Ingresar Distrito de la Sede",1,"form-control"],["for","provincia",1,"required","form-label"],["type","text","id","provincia","formControlName","provincia","placeholder","Ingresar Provincia de la Sede",1,"form-control"],["for","departamento",1,"required","form-label"],["type","text","id","departamento","formControlName","departamento","placeholder","Ingresar Departamento de la Sede",1,"form-control"],["for","telefono",1,"required","form-label"],["type","text","id","telefono","formControlName","telefono","placeholder","Ingresar Tel\xE9fono de la Sede",1,"form-control"],[1,"form-group"],["for","email",1,"required","form-label"],["type","email","id","email","formControlName","email","placeholder","Ingresar Correo de la Sede",1,"form-control"],[1,"form-group","mb-3","col-6"],["for","kt_calendar_datepicker_start_time"],["type","text","id","kt_calendar_datepicker_start_time","formControlName","horarioapertura","placeholder","Seleccionar Hora de Inicio",1,"form-control",3,"change"],["for","kt_calendar_datepicker_end_time"],["type","text","id","kt_calendar_datepicker_end_time","formControlName","horariocierre","placeholder","Seleccionar Hora de Fin",1,"form-control"],["for","capacidadpacientes",1,"required","form-label"],["type","number","id","capacidadpacientes","formControlName","capacidadpacientes","min","1","placeholder","Ingresar Capacidad de Pacientes",1,"form-control"],["for","numeroconsultorios",1,"required","form-label"],["type","number","id","numeroconsultorios","formControlName","numeroconsultorios","min","1","placeholder","Ingresar N\xB0 de Consultorios",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(l,d){if(l&1){let s=U();t(0,"div",2)(1,"h4",3)(2,"span",4)(3,"i",5),n(4,"span",6)(5,"span",7)(6,"span",8),e()(),r(7," A\xF1adir Sede "),e(),t(8,"button",9),m("click",function(){return N(s),I(d.close())}),t(9,"i",10),n(10,"span",6)(11,"span",7),e()()(),t(12,"div",11)(13,"form",12)(14,"div",13)(15,"div",14)(16,"label",15),r(17,"Nombre de la Sede"),e(),n(18,"input",16),e(),t(19,"div",14)(20,"label",17),r(21,"Direcci\xF3n"),e(),n(22,"input",18),e()(),t(23,"div",13)(24,"div",14)(25,"label",19),r(26,"Distrito"),e(),n(27,"input",20),e(),t(28,"div",14)(29,"label",21),r(30,"Provincia"),e(),n(31,"input",22),e()(),t(32,"div",13)(33,"div",14)(34,"label",23),r(35,"Departamento"),e(),n(36,"input",24),e(),t(37,"div",14)(38,"label",25),r(39,"Tel\xE9fono"),e(),n(40,"input",26),e()(),t(41,"div",27)(42,"label",28),r(43,"Correo Electr\xF3nico"),e(),n(44,"input",29),e(),t(45,"div",13)(46,"div",30)(47,"label",31),r(48,"Hora de Apertura"),e(),t(49,"input",32,0),m("change",function(he){return N(s),I(d.onStartTimeChange(he))}),e()(),t(51,"div",30)(52,"label",33),r(53,"Hora de Cierre"),e(),n(54,"input",34,1),e()(),t(56,"div",13)(57,"div",14)(58,"label",35),r(59,"Capacidad de Pacientes"),e(),n(60,"input",36),e(),t(61,"div",14)(62,"label",37),r(63,"N\xFAmero de Consultorios"),e(),n(64,"input",38),e()()()(),t(65,"div",39)(66,"button",40),m("click",function(){return N(s),I(d.close())}),r(67," Cancelar "),e(),t(68,"button",41),b(69,"async"),m("click",function(){return N(s),I(d.save())}),r(70," Guardar "),C(71,ve,1,0,"span",42),b(72,"async"),e()()}l&2&&(h(13),f("formGroup",d.sedeForm),h(55),f("disabled",d.sedeForm.invalid||g(69,3,d.isLoading)),h(3),f("ngIf",g(72,5,d.isLoading)))},dependencies:[F,Z,K,ee,X,Y,ne,te,ie,E,M,y]});let o=i;return o})();function Se(o,i){o&1&&n(0,"span",13)}var pe=(()=>{let i=class i{constructor(){this.modal=u(k),this.sedeService=u(T),this.isLoading=u(x).isLoading,this.sedeId="",this.onSaveComplete=new D}close(){this.modal.dismissAll()}delete(){let a=typeof this.sedeId=="string"?parseInt(this.sedeId,10):parseInt(this.sedeId.id_sedes,10);isNaN(a)?console.error("ID de la sede no proporcionado o en formato incorrecto"):this.sedeService.delete(a).subscribe({next:()=>{this.onSaveComplete.emit(),this.modal.dismissAll()},error:l=>{console.error("Error al eliminar sede:",l)}})}};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=S({type:i,selectors:[["app-borrar-modal"]],inputs:{sedeId:"sedeId"},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[_],decls:25,vars:6,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-information","text-danger","fs-2hx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body","text-center"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(l,d){l&1&&(t(0,"div",0)(1,"h4",1)(2,"span")(3,"i",2),n(4,"span",3)(5,"span",4)(6,"span",5),e()(),r(7," Eliminar Sede "),e(),t(8,"button",6),m("click",function(){return d.close()}),t(9,"i",7),n(10,"span",3)(11,"span",4),e()()(),t(12,"div",8)(13,"p"),r(14,"\xBFEst\xE1s seguro de eliminar esta sede?"),e(),t(15,"p"),r(16,"Toda la informaci\xF3n relacionada con esta sede se perder\xE1."),e()(),t(17,"div",9)(18,"button",10),m("click",function(){return d.close()}),r(19," Cancelar "),e(),t(20,"button",11),b(21,"async"),m("click",function(){return d.delete()}),r(22," Eliminar "),C(23,Se,1,0,"span",12),b(24,"async"),e()()),l&2&&(h(20),f("disabled",g(21,2,d.isLoading)),h(3),f("ngIf",g(24,4,d.isLoading)))},dependencies:[F,E,M,y]});let o=i;return o})();var ue=(()=>{let i=class i{ngOnInit(){}agInit(a){this.params=a}openEdit(){this.params?.onEdit(this.params.data)}openDelete(){this.params?.onDelete(this.params.data)}refresh(a){return!0}};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=S({type:i,selectors:[["app-sedes-action-buttons"]],decls:5,vars:0,consts:[[1,"d-flex","align-items-center","gap-2",2,"padding-block","0.15rem"],["type","button",1,"btn","btn-icon","btn-sm","bg-success",3,"click"],[1,"ki-solid","ki-pencil","text-white"],["type","button",1,"btn","btn-icon","btn-sm","btn-danger",3,"click"],[1,"ki-solid","ki-trash","text-white"]],template:function(l,d){l&1&&(t(0,"div",0)(1,"button",1),m("click",function(){return d.openEdit()}),n(2,"span",2),e(),t(3,"button",3),m("click",function(){return d.openDelete()}),n(4,"span",4),e()())}});let o=i;return o})();var Ce=()=>[y,import("./chunk-CY3GPE7K.js").then(o=>o.AgGridAngular)],_e=o=>[o];function ye(o,i){if(o&1&&(n(0,"ag-grid-angular",22),b(1,"async"),b(2,"async")),o&2){let p=W();f("rowData",g(1,7,p.sedesList))("localeText",p.localeText)("ariaHidden",!0)("enableCellTextSelection",!0)("loading",g(2,9,p.isLoading))("columnDefs",p.colDefs)("pagination",!0)}}function Ee(o,i){o&1&&(t(0,"div",23)(1,"div",24)(2,"span",25),r(3,"Loading..."),e()()())}var v,fe=(v=class{constructor(){this.sedesService=u(T),this.isLoading=u(x).isLoading,this.theme=u(oe),this.modal=u(k),this.localeText=de,this.sedesList=new V,this.colDefs=[{field:"nombre",headerName:"Nombre",filter:!0},{field:"direccion",headerName:"Direcci\xF3n",filter:!0},{field:"distrito",headerName:"Distrito",filter:!0},{field:"provincia",headerName:"Provincia",filter:!0},{field:"departamento",headerName:"Departamento",filter:!0},{field:"telefono",headerName:"Telefono",filter:!0},{field:"email",headerName:"Correo",filter:!0},{field:"horarioapertura",headerName:"Hora de Apertura"},{field:"horariocierre",headerName:"Hora de Cierre"},{field:"capacidadpacientes",headerName:"Capacidad de Pacientes",filter:"agNumberColumnFilter"},{field:"numeroconsultorios",headerName:"N\xFAmero de Consultorios",filter:"agNumberColumnFilter"},{headerName:"Acciones",cellRenderer:ue,cellRendererParams:{onEdit:i=>this.openEditarModal(i),onDelete:i=>this.openBorrarModal(i)},maxWidth:100,resizable:!1}]}ngOnInit(){this.fetchSedes()}ngOnDestroy(){}fetchSedes(){this.sedesList=this.sedesService.getAll().pipe(H(i=>i.data))}loadTabla(){this.fetchSedes()}gridReady(i){this.gridApi=i.api}onFilterTextBoxChanged(){this.gridApi.setGridOption("quickFilterText",document.getElementById("sede-search").value)}openCrearModal(){this.modal.open(ce,{size:"300px",animation:!0,centered:!0}).componentInstance.onSaveComplete.subscribe(()=>{this.fetchSedes()})}openEditarModal(i){let p=this.modal.open(se);p.componentInstance.sedeId=i.id_sede,p.componentInstance.onSaveComplete.subscribe(()=>{this.fetchSedes()})}openBorrarModal(i){if(!i.id_sede){console.error("La sede no tiene un id_sede definido.");return}let p=this.modal.open(pe,{size:"300px",animation:!0,centered:!0});p.componentInstance.sedeId=i.id_sede,p.componentInstance.onSaveComplete.subscribe(()=>{this.fetchSedes()})}},v.\u0275fac=function(p){return new(p||v)},v.\u0275cmp=S({type:v,selectors:[["app-sedes"]],standalone:!0,features:[_],decls:31,vars:3,consts:[["header-title",""],[1,"d-flex","flex-column","text-gray-900","fw-bold","my-1"],[1,"",2,"color","white"],[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],[1,"card","p-2","px-4"],[1,"d-flex","py-4","justify-content-between","align-items-center"],["data-kt-search-element","form","autocomplete","off",1,"position-relative"],["type","hidden"],[1,"ki-duotone","ki-magnifier","fs-2","search-icon","position-absolute","top-50","translate-middle-y","ms-4"],[1,"path1"],[1,"path2"],["type","search","id","sede-search","name","search","value","","placeholder","B\xFAsqueda","data-kt-search-element","input",1,"form-control","custom-form-control","ps-13",3,"input"],[1,"d-flex","align-items-center","gap-3"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"ki-solid","ki-plus","text-white","fs-1"],[1,"text-white","ms-2"],["id","myGrid",2,"height","400px",3,"ngClass"],["loadingMessage","Cargando...",2,"width","100%","height","100%",3,"rowData","localeText","ariaHidden","enableCellTextSelection","loading","columnDefs","pagination"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100%"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(p,a){p&1&&(t(0,"app-header"),z(1,0),t(2,"h1",1)(3,"span",2),r(4,"Sedes"),e()(),Q(),e(),t(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"form",7),n(10,"input",8),t(11,"i",9),n(12,"span",10)(13,"span",11),e(),t(14,"input",12),m("input",function(){return a.onFilterTextBoxChanged()}),e()(),t(15,"div",13)(16,"button",14),m("click",function(){return a.loadTabla()}),t(17,"span",15),n(18,"span",16),t(19,"span",17),r(20,"Actualizar"),e()()(),t(21,"button",18),m("click",function(){return a.openCrearModal()}),t(22,"span",15),n(23,"span",19),t(24,"span",20),r(25,"A\xF1adir"),e()()()()(),t(26,"div",21),C(27,ye,3,11)(28,Ee,4,0),O(29,27,Ce,28),j(),e()()()()),p&2&&(h(26),f("ngClass",$(1,_e,a.theme.getThemeMode()==="light"?"ag-theme-quartz":"ag-theme-quartz-dark")))},dependencies:[E,J,ae]}),v);fe=R([le()],fe);export{fe as SedesComponent};
