import{a as de}from"./chunk-Z5WI6S6S.js";import{a as k}from"./chunk-K4GGBFBA.js";import{a as q}from"./chunk-GT4JH6HJ.js";import{a as le}from"./chunk-KG3B2A6X.js";import{a as ae}from"./chunk-U2EAJGNN.js";import{o as y,u as oe}from"./chunk-AAYOZ3JU.js";import{a as E}from"./chunk-NMGGHNE5.js";import"./chunk-BIMAMPZW.js";import{a as re}from"./chunk-KNEUCQQI.js";import"./chunk-GKZUPR7X.js";import{B as ee,E as te,I as ie,L as ne,N as I,q as J,r as c,s as K,t as X,y as Y,z as Z}from"./chunk-ZM3MROS5.js";import{m as $,o as M,t as S,v as _}from"./chunk-DP3M2V7L.js";import{Aa as g,C as R,Gc as C,Ic as W,Ka as x,La as T,Lb as v,Nc as h,Oc as b,Pb as G,Rb as O,Ta as N,Ub as u,bc as t,cc as e,dc as r,ec as j,fc as z,hc as Q,n as P,nc as m,oc as U,uc as F,v as V,vb as f,vc as w,wa as p,wb as H,wc as A,yc as o}from"./chunk-B7JMKZ3I.js";var he=["startTimePicker"],be=["endTimePicker"];function ge(n,d){n&1&&r(0,"span",43)}var me=(()=>{class n{constructor(i){this.fb=i,this.modal=p(y),this.sedeService=p(k),this.loadingService=p(E),this.isLoading=this.loadingService.isLoading,this.onSaveComplete=new N,this.sedeForm=this.fb.group({nombre:["",c.required],direccion:["",c.required],distrito:["",c.required],provincia:["",c.required],departamento:["",c.required],telefono:["",[c.required,c.pattern("^[0-9]+$")]],email:["",[c.required,c.email]],horarioapertura:["",c.required],horariocierre:["",c.required],capacidadpacientes:["",[c.required,c.min(1)]],numeroconsultorios:["",[c.required,c.min(1)]]})}ngAfterViewInit(){this.startTimePicker&&this.startTimePicker.nativeElement&&q(this.startTimePicker.nativeElement,{enableTime:!0,noCalendar:!0,dateFormat:"H:i"}),this.endTimePicker&&this.endTimePicker.nativeElement&&q(this.endTimePicker.nativeElement,{enableTime:!0,noCalendar:!0,dateFormat:"H:i"})}close(){this.modal.dismissAll()}save(){this.sedeForm.valid&&(this.loadingService.setLoading(!0,"sede/create"),this.sedeService.create(this.sedeForm.value).subscribe({next:i=>{this.loadingService.setLoading(!1,"sede/create"),this.onSaveComplete.emit(),this.close()},error:i=>{console.error("Error al crear sede:",i),this.loadingService.setLoading(!1,"sede/create")}}))}onStartTimeChange(i){let[a,l]=i.target.value.split(":").map(Number),s=new Date;s.setHours(a,l+1),this.endTimePicker.nativeElement._flatpickr.set("minDate",s)}static{this.\u0275fac=function(a){return new(a||n)(H(ne))}}static{this.\u0275cmp=g({type:n,selectors:[["app-crear-modal"]],viewQuery:function(a,l){if(a&1&&(F(he,5),F(be,5)),a&2){let s;w(s=A())&&(l.startTimePicker=s.first),w(s=A())&&(l.endTimePicker=s.first)}},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[C],decls:73,vars:7,consts:[["startTimePicker",""],["endTimePicker",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-add-files","text-gray-900","fs-1",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"formGroup"],[1,"row"],[1,"form-group","col-6"],["for","nombre",1,"required","form-label"],["type","text","id","nombre","formControlName","nombre","placeholder","Ingresar Nombre de la Sede",1,"form-control"],["for","direccion",1,"required","form-label"],["type","text","id","direccion","formControlName","direccion","placeholder","Ingresar Direcci\xF3n de la Sede",1,"form-control"],["for","distrito",1,"required","form-label"],["type","text","id","distrito","formControlName","distrito","placeholder","Ingresar Distrito de la Sede",1,"form-control"],["for","provincia",1,"required","form-label"],["type","text","id","provincia","formControlName","provincia","placeholder","Ingresar Provincia de la Sede",1,"form-control"],["for","departamento",1,"required","form-label"],["type","text","id","departamento","formControlName","departamento","placeholder","Ingresar Departamento de la Sede",1,"form-control"],["for","telefono",1,"required","form-label"],["type","text","id","telefono","formControlName","telefono","placeholder","Ingresar Tel\xE9fono de la Sede",1,"form-control"],[1,"form-group"],["for","email",1,"required","form-label"],["type","email","id","email","formControlName","email","placeholder","Ingresar Correo de la Sede",1,"form-control"],[1,"form-group","mb-3","col-6"],["for","kt_calendar_datepicker_start_time"],["type","text","id","kt_calendar_datepicker_start_time","formControlName","horarioapertura","placeholder","Seleccionar Hora de Inicio",1,"form-control",3,"change"],["for","kt_calendar_datepicker_end_time"],["type","text","id","kt_calendar_datepicker_end_time","formControlName","horariocierre","placeholder","Seleccionar Hora de Fin",1,"form-control"],["for","capacidadpacientes",1,"required","form-label"],["type","number","id","capacidadpacientes","formControlName","capacidadpacientes","min","1","placeholder","Ingresar Capacidad de Pacientes",1,"form-control"],["for","numeroconsultorios",1,"required","form-label"],["type","number","id","numeroconsultorios","formControlName","numeroconsultorios","min","1","placeholder","Ingresar N\xB0 de Consultorios",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(a,l){if(a&1){let s=Q();t(0,"div",2)(1,"h4",3)(2,"span",4)(3,"i",5),r(4,"span",6)(5,"span",7)(6,"span",8),e()(),o(7," A\xF1adir Sede "),e(),t(8,"button",9),m("click",function(){return x(s),T(l.close())}),t(9,"i",10),r(10,"span",6)(11,"span",7),e()()(),t(12,"div",11)(13,"form",12)(14,"div",13)(15,"div",14)(16,"label",15),o(17,"Nombre de la Sede"),e(),r(18,"input",16),e(),t(19,"div",14)(20,"label",17),o(21,"Direcci\xF3n"),e(),r(22,"input",18),e()(),t(23,"div",13)(24,"div",14)(25,"label",19),o(26,"Distrito"),e(),r(27,"input",20),e(),t(28,"div",14)(29,"label",21),o(30,"Provincia"),e(),r(31,"input",22),e()(),t(32,"div",13)(33,"div",14)(34,"label",23),o(35,"Departamento"),e(),r(36,"input",24),e(),t(37,"div",14)(38,"label",25),o(39,"Tel\xE9fono"),e(),r(40,"input",26),e()(),t(41,"div",27)(42,"label",28),o(43,"Correo Electr\xF3nico"),e(),r(44,"input",29),e(),t(45,"div",13)(46,"div",30)(47,"label",31),o(48,"Hora de Apertura"),e(),t(49,"input",32,0),m("change",function(fe){return x(s),T(l.onStartTimeChange(fe))}),e()(),t(51,"div",30)(52,"label",33),o(53,"Hora de Cierre"),e(),r(54,"input",34,1),e()(),t(56,"div",13)(57,"div",14)(58,"label",35),o(59,"Capacidad de Pacientes"),e(),r(60,"input",36),e(),t(61,"div",14)(62,"label",37),o(63,"N\xFAmero de Consultorios"),e(),r(64,"input",38),e()()()(),t(65,"div",39)(66,"button",40),m("click",function(){return x(s),T(l.close())}),o(67," Cancelar "),e(),t(68,"button",41),h(69,"async"),m("click",function(){return x(s),T(l.save())}),o(70," Guardar "),v(71,ge,1,0,"span",42),h(72,"async"),e()()}a&2&&(f(13),u("formGroup",l.sedeForm),f(55),u("disabled",l.sedeForm.invalid||b(69,3,l.isLoading)),f(3),u("ngIf",b(72,5,l.isLoading)))},dependencies:[I,Y,J,Z,K,X,ie,ee,te,_,M,S]})}}return n})();function ve(n,d){n&1&&r(0,"span",13)}var ce=(()=>{class n{constructor(){this.modal=p(y),this.sedeService=p(k),this.isLoading=p(E).isLoading,this.sedeId="",this.onSaveComplete=new N}close(){this.modal.dismissAll()}delete(){let i=typeof this.sedeId=="string"?parseInt(this.sedeId,10):parseInt(this.sedeId.id_sedes,10);isNaN(i)?console.error("ID de la sede no proporcionado o en formato incorrecto"):this.sedeService.delete(i).subscribe({next:()=>{this.onSaveComplete.emit(),this.modal.dismissAll()},error:a=>{console.error("Error al eliminar sede:",a)}})}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-borrar-modal"]],inputs:{sedeId:"sedeId"},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[C],decls:25,vars:6,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-information","text-danger","fs-2hx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body","text-center"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(a,l){a&1&&(t(0,"div",0)(1,"h4",1)(2,"span")(3,"i",2),r(4,"span",3)(5,"span",4)(6,"span",5),e()(),o(7," Eliminar Sede "),e(),t(8,"button",6),m("click",function(){return l.close()}),t(9,"i",7),r(10,"span",3)(11,"span",4),e()()(),t(12,"div",8)(13,"p"),o(14,"\xBFEst\xE1s seguro de eliminar esta sede?"),e(),t(15,"p"),o(16,"Toda la informaci\xF3n relacionada con esta sede se perder\xE1."),e()(),t(17,"div",9)(18,"button",10),m("click",function(){return l.close()}),o(19," Cancelar "),e(),t(20,"button",11),h(21,"async"),m("click",function(){return l.delete()}),o(22," Eliminar "),v(23,ve,1,0,"span",12),h(24,"async"),e()()),a&2&&(f(20),u("disabled",b(21,2,l.isLoading)),f(3),u("ngIf",b(24,4,l.isLoading)))},dependencies:[I,_,M,S]})}}return n})();var pe=(()=>{class n{ngOnInit(){}agInit(i){this.params=i}openEdit(){this.params?.onEdit(this.params.data)}openDelete(){this.params?.onDelete(this.params.data)}refresh(i){return!0}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-sedes-action-buttons"]],decls:5,vars:0,consts:[[1,"d-flex","align-items-center","gap-2",2,"padding-block","0.15rem"],["type","button",1,"btn","btn-icon","btn-sm","bg-success",3,"click"],[1,"ki-solid","ki-pencil","text-white"],["type","button",1,"btn","btn-icon","btn-sm","btn-danger",3,"click"],[1,"ki-solid","ki-trash","text-white"]],template:function(a,l){a&1&&(t(0,"div",0)(1,"button",1),m("click",function(){return l.openEdit()}),r(2,"span",2),e(),t(3,"button",3),m("click",function(){return l.openDelete()}),r(4,"span",4),e()())}})}}return n})();var Ce=()=>[S,import("./chunk-TDDSBCRP.js").then(n=>n.AgGridAngular)],Se=n=>[n];function _e(n,d){if(n&1&&(r(0,"ag-grid-angular",22),h(1,"async"),h(2,"async")),n&2){let i=U();u("rowData",b(1,7,i.sedesList))("localeText",i.localeText)("ariaHidden",!0)("enableCellTextSelection",!0)("loading",b(2,9,i.isLoading))("columnDefs",i.colDefs)("pagination",!0)}}function ye(n,d){n&1&&(t(0,"div",23)(1,"div",24)(2,"span",25),o(3,"Loading..."),e()()())}var ue=class L{constructor(){this.sedesService=p(k),this.isLoading=p(E).isLoading,this.theme=p(re),this.modal=p(y),this.localeText=ae,this.sedesList=new P,this.colDefs=[{field:"nombre",headerName:"Nombre",filter:!0},{field:"direccion",headerName:"Direcci\xF3n",filter:!0},{field:"distrito",headerName:"Distrito",filter:!0},{field:"provincia",headerName:"Provincia",filter:!0},{field:"departamento",headerName:"Departamento",filter:!0},{field:"telefono",headerName:"Telefono",filter:!0},{field:"email",headerName:"Correo",filter:!0},{field:"horarioapertura",headerName:"Hora de Apertura"},{field:"horariocierre",headerName:"Hora de Cierre"},{field:"capacidadpacientes",headerName:"Capacidad de Pacientes",filter:"agNumberColumnFilter"},{field:"numeroconsultorios",headerName:"N\xFAmero de Consultorios",filter:"agNumberColumnFilter"},{headerName:"Acciones",cellRenderer:pe,cellRendererParams:{onEdit:d=>this.openEditarModal(d),onDelete:d=>this.openBorrarModal(d)},maxWidth:100,resizable:!1}]}ngOnInit(){this.fetchSedes()}ngOnDestroy(){}fetchSedes(){this.sedesList=this.sedesService.getAll().pipe(R(d=>d.data))}loadTabla(){this.fetchSedes()}gridReady(d){this.gridApi=d.api}onFilterTextBoxChanged(){this.gridApi.setGridOption("quickFilterText",document.getElementById("sede-search").value)}openCrearModal(){this.modal.open(me,{size:"300px",animation:!0,centered:!0}).componentInstance.onSaveComplete.subscribe(()=>{this.fetchSedes()})}openEditarModal(d){let i=this.modal.open(de);i.componentInstance.sedeId=d.id_sede,i.componentInstance.onSaveComplete.subscribe(()=>{this.fetchSedes()})}openBorrarModal(d){if(!d.id_sede){console.error("La sede no tiene un id_sede definido.");return}let i=this.modal.open(ce,{size:"300px",animation:!0,centered:!0});i.componentInstance.sedeId=d.id_sede,i.componentInstance.onSaveComplete.subscribe(()=>{this.fetchSedes()})}static{this.\u0275fac=function(i){return new(i||L)}}static{this.\u0275cmp=g({type:L,selectors:[["app-sedes"]],standalone:!0,features:[C],decls:31,vars:3,consts:[["header-title",""],[1,"d-flex","flex-column","text-gray-900","fw-bold","my-1"],[1,"",2,"color","white"],[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],[1,"card","p-2","px-4"],[1,"d-flex","py-4","justify-content-between","align-items-center"],["data-kt-search-element","form","autocomplete","off",1,"position-relative"],["type","hidden"],[1,"ki-duotone","ki-magnifier","fs-2","search-icon","position-absolute","top-50","translate-middle-y","ms-4"],[1,"path1"],[1,"path2"],["type","search","id","sede-search","name","search","value","","placeholder","B\xFAsqueda","data-kt-search-element","input",1,"form-control","custom-form-control","ps-13",3,"input"],[1,"d-flex","align-items-center","gap-3"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"ki-solid","ki-plus","text-white","fs-1"],[1,"text-white","ms-2"],["id","myGrid",2,"height","calc(100dvh - 281px)",3,"ngClass"],["loadingMessage","Cargando...",2,"width","100%","height","100%",3,"rowData","localeText","ariaHidden","enableCellTextSelection","loading","columnDefs","pagination"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100%"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(i,a){i&1&&(t(0,"app-header"),j(1,0),t(2,"h1",1)(3,"span",2),o(4,"Sedes"),e()(),z(),e(),t(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"form",7),r(10,"input",8),t(11,"i",9),r(12,"span",10)(13,"span",11),e(),t(14,"input",12),m("input",function(){return a.onFilterTextBoxChanged()}),e()(),t(15,"div",13)(16,"button",14),m("click",function(){return a.loadTabla()}),t(17,"span",15),r(18,"span",16),t(19,"span",17),o(20,"Actualizar"),e()()(),t(21,"button",18),m("click",function(){return a.openCrearModal()}),t(22,"span",15),r(23,"span",19),t(24,"span",20),o(25,"A\xF1adir"),e()()()()(),t(26,"div",21),v(27,_e,3,11)(28,ye,4,0),G(29,27,Ce,28),O(),e()()()()),i&2&&(f(26),u("ngClass",W(1,Se,a.theme.getThemeMode()==="light"?"ag-theme-quartz":"ag-theme-quartz-dark")))},dependencies:[_,$,oe]})}};ue=V([le()],ue);export{ue as SedesComponent};
