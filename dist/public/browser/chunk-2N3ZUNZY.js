import{a as I,b as L,c as k,d as O,e as R,f as V,g as z}from"./chunk-CUMGWIKM.js";import"./chunk-OSUEIBEK.js";import{a as J}from"./chunk-AHYCEPXJ.js";import{c as U}from"./chunk-HU6BYMHG.js";import{a as G,b as y}from"./chunk-OO4BC6LN.js";import{a as $}from"./chunk-67M5LFVM.js";import"./chunk-GKZUPR7X.js";import{j as B}from"./chunk-QUGPZPJP.js";import{m as M,t as E,v as F}from"./chunk-O2FCGDZ2.js";import{Ba as q,Bc as n,C as b,Cc as x,Jc as P,La as g,Lc as j,Ma as _,Qc as u,Rc as f,Vb as p,ac as w,cc as A,dc as D,ec as o,fc as a,gc as H,kc as N,n as h,qc as v,r as C,rc as m,v as T,wb as c,xa as l}from"./chunk-H565K2KG.js";var Q=r=>[r];function W(r,t){if(r&1){let e=N();o(0,"div",2),v("shown",function(){let s=g(e).$implicit,d=m();return _(d.loadHistorialData(s.id))}),o(1,"div",3)(2,"div",4)(3,"div")(4,"span",5),n(5),a(),o(6,"span"),n(7),a()(),o(8,"button",6),n(9,"Historial"),a()(),o(10,"div",7)(11,"div",8)(12,"div",4)(13,"span",9),n(14,"Historial de compras"),a(),o(15,"button",10),v("click",function(){let s=g(e).$implicit,d=m();return _(d.loadHistorialData(s.id,!0))}),n(16,"Actualizar"),a()(),o(17,"div",11),H(18,"ag-grid-angular",12),u(19,"async"),u(20,"async"),a()()()()()}if(r&2){let e=t.$implicit,i=m();p("destroyOnHide",!0),c(5),x(e.paquete),c(2),x(e.num_sesiones),c(10),p("ngClass",j(15,Q,i.theme.getThemeMode()==="light"?"ag-theme-quartz":"ag-theme-quartz-dark")),c(),p("rowData",f(19,11,i.getHistorialSubject(e.id)))("columnDefs",i.columnDefs)("loading",f(20,13,i.isLoading))("localeText",i.localeText)("enableCellTextSelection",!0)("ariaHidden",!0)("pagination",!0)}}function X(r,t){r&1&&(o(0,"div"),n(1,"No hay paquetes"),a())}var K=class S{constructor(){this.reporteService=l(J),this.activatedRoute=l(B),this.theme=l($),this.id_paciente=this.activatedRoute.snapshot.paramMap.get("id"),this.historialList=new h,this.paquetesList=new h,this.historialData=[],this.historialSubjects=new Map,this.dataLoaded=new Map,this.columnDefs=[{field:"id_pa",headerName:"ID",filter:!0},{field:"num_sesiones",headerName:"N\xB0 Sesiones",filter:!0},{field:"metodo_pago",headerName:"M\xE9todo de Pago",filter:!0},{field:"precio",headerName:"Precio",filter:!0},{field:"fecha_compra",headerName:"Fecha Compra",filter:!0}]}getHistorialSubject(t){if(!this.historialSubjects.has(t)){let e=new C([]);this.historialSubjects.set(t,e)}return this.historialSubjects.get(t)}ngOnInit(){this.getPaquetes()}loadHistorialData(t,e=!1){this.reporteService.getPaquetes(this.id_paciente).pipe(b(i=>i.data.compras.flatMap(s=>s.historial.filter(d=>d.id_paq===t))),y(this)).subscribe(i=>{this.getHistorialSubject(t).next(i)})}getPaquetes(){this.paquetesList=this.reporteService.getPaquetes(this.id_paciente).pipe(b(t=>t.data.compras),y(this))}static{this.\u0275fac=function(e){return new(e||S)}}static{this.\u0275cmp=q({type:S,selectors:[["app-tab-paquetes"]],standalone:!0,features:[P],decls:5,vars:3,consts:[[1,"d-flex","flex-column","gap-4"],["ngbAccordion","",1,"card","card-body","border-1","border-gray-300","d-flex","gap-4",3,"destroyOnHide"],["ngbAccordion","",1,"card","card-body","border-1","border-gray-300","d-flex","gap-4",3,"shown","destroyOnHide"],["ngbAccordionItem",""],[1,"d-flex","justify-content-between","align-items-center"],["ngbAccordionHeader","",1,"fw-bold","fs-5"],["ngbAccordionToggle","",1,"btn","btn-sm","bt-secondary"],["ngbAccordionCollapse",""],["ngbAccordionBody",""],[1,"fw-bold","fs-5"],[1,"btn","btn-sm","btn-secondary",3,"click"],[2,"height","300px",3,"ngClass"],[2,"width","100%","height","100%",3,"rowData","columnDefs","loading","localeText","enableCellTextSelection","ariaHidden","pagination"]],template:function(e,i){e&1&&(o(0,"div",0),A(1,W,21,17,"div",1,w,!1,X,2,0,"div"),u(4,"async"),a()),e&2&&(c(),D(f(4,1,i.paquetesList)))},dependencies:[U,F,M,E,z,V,R,O,k,I,L]})}};K=T([G()],K);export{K as TabPaquetesComponent};
