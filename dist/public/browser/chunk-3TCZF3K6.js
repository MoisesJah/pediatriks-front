import{a as B}from"./chunk-7YUY65AQ.js";import{a as v}from"./chunk-U3X3T6AK.js";import{a as ge}from"./chunk-VIK6P75G.js";import{a as he}from"./chunk-WFL7FBLQ.js";import{a as ce}from"./chunk-GT4JH6HJ.js";import"./chunk-EBZKSOFQ.js";import{c as fe}from"./chunk-HC5HCKLL.js";import{a as te}from"./chunk-4JVWF6E6.js";import{o as C}from"./chunk-47BWZHPK.js";import{A as me,c as ie,d as ne,e as re,f as oe,k as ae,m as se,o as le,r as de,y as T}from"./chunk-JV7DKPVM.js";import{a as be}from"./chunk-4AG4EE5Y.js";import{a as ue}from"./chunk-U2EAJGNN.js";import{a as M}from"./chunk-MKNMNAUM.js";import{a as N,b as y}from"./chunk-TA6YOJTR.js";import{a as pe}from"./chunk-T5KXAZJZ.js";import"./chunk-GKZUPR7X.js";import{j as E,l as R}from"./chunk-P5QLGDHL.js";import{j as Q,m as X,o as Z,t as F,u as ee,w}from"./chunk-CWIGPBJP.js";import{Ba as u,C as O,Fc as m,La as G,Ma as U,Mb as D,Qb as H,Qc as g,S as j,Sb as q,Sc as K,Ua as V,Vb as f,Xc as b,Yc as _,fc as i,gc as r,hc as s,ic as $,jc as Y,lc as J,n as z,od as A,uc as c,v as x,vc as P,w as k,wb as h,xa as a,xb as p,y as S}from"./chunk-JCDSCFF6.js";function xe(o,t){o&1&&s(0,"span",27)}var I=class L{ngOnInit(){}constructor(t){this.fb=t,this.modal=a(C),this.citaService=a(v),this.isLoading=a(M).isLoading,this.toastService=a(he),this.citaUpdated=new V,this.id_sesion="",this.confirmForm=this.fb.group({id_status:[null,ne.required]})}confirm(){this.citaService.updateStatus({id_sesion:this.id_sesion,id_status:this.confirmForm.value.id_status}).pipe(y(this)).subscribe({next:()=>{this.citaUpdated.emit(),this.close()},error:t=>{if(t.error.errors){let e=Object.values(t.error.errors).join("");this.toastService.error(e,"Error")}}})}close(){this.modal.dismissAll()}static{this.\u0275fac=function(e){return new(e||L)(p(T))}}static{this.\u0275cmp=u({type:L,selectors:[["app-confirm-asistio"]],outputs:{citaUpdated:"citaUpdated"},standalone:!0,features:[g],decls:45,vars:7,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-time","text-gray-900","fs-2x"],[1,"path1"],[1,"path2"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"d-flex","flex-row","justify-content-evenly","gap-3",3,"formGroup"],["type","radio","formControlName","id_status","value","2","checked","checked","id","kt_radio_buttons_2_option_1",1,"btn-check"],["for","kt_radio_buttons_2_option_1",1,"btn","btn-outline","btn-outline-success","btn-outline-dashed","btn-active-light-success","p-7","d-flex","flex-column","gap-2","align-items-center",2,"min-width","135px"],[1,"ki-duotone","ki-calendar-tick","fs-4x"],[1,"path3"],[1,"path4"],[1,"path5"],[1,"path6"],[1,"d-flex","flex-stack","justify-content-center","fw-semibold","text-center"],[1,"text-gray-900","fw-bold","d-block","fs-3"],["type","radio","formControlName","id_status","value","3","id","kt_radio_buttons_2_option_2",1,"btn-check"],["for","kt_radio_buttons_2_option_2",1,"btn","btn-outline","btn-outline-dashed","btn-outline-danger","btn-active-light-danger","p-7","d-flex","flex-column","gap-2","align-items-center"],[1,"ki-duotone","ki-calendar-remove","fs-4x"],[1,"d-block","fw-semibold","text-start"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"h4",1)(2,"span",2)(3,"i",3),s(4,"span",4)(5,"span",5),r()(),m(6," Confirmar Asistencia "),r(),i(7,"button",6),c("click",function(){return n.close()}),i(8,"i",7),s(9,"span",4)(10,"span",5),r()()(),i(11,"div",8)(12,"form",9),s(13,"input",10),i(14,"label",11)(15,"i",12),s(16,"span",4)(17,"span",5)(18,"span",13)(19,"span",14)(20,"span",15)(21,"span",16),r(),i(22,"span",17)(23,"span",18),m(24,"Asisti\xF3"),r()()(),s(25,"input",19),i(26,"label",20)(27,"i",21),s(28,"span",4)(29,"span",5)(30,"span",13)(31,"span",14)(32,"span",15)(33,"span",16),r(),i(34,"span",22)(35,"span",18),m(36,"No Asisti\xF3"),r()()()()(),i(37,"div",23)(38,"button",24),c("click",function(){return n.close()}),m(39," Cancelar "),r(),i(40,"button",25),b(41,"async"),c("click",function(){return n.confirm()}),D(42,xe,1,0,"span",26),b(43,"async"),m(44," Confirmar "),r()()),e&2&&(h(12),f("formGroup",n.confirmForm),h(28),f("disabled",n.confirmForm.invalid||_(41,3,n.isLoading)),h(2),f("ngIf",_(43,5,n.isLoading)))},dependencies:[me,ae,ie,se,re,oe,le,de,w,Z,F]})}};I=x([N(),k("design:paramtypes",[T])],I);var Ce=(()=>{class o{constructor(){this.modal=a(C),this.id_session=""}ngOnInit(){}agInit(e){this.params=e,this.id_session=e.data.id}openModal(){this.params.openModal(this.id_session)}refresh(e){return!0}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=u({type:o,selectors:[["app-btn-assits"]],standalone:!0,features:[g],decls:4,vars:0,consts:[["type","button",1,"btn","btn-sm","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"fa-solid","fa-file-lines","text-gray-900","fs-1"]],template:function(n,d){n&1&&(i(0,"button",0),c("click",function(){return d.openModal()}),s(1,"i",1),i(2,"span"),m(3,"Confirmar"),r()())}})}}return o})();var ke=()=>[F,import("./chunk-I6V2XIWU.js").then(o=>o.AgGridAngular)],Se=o=>[o];function De(o,t){if(o&1){let e=J();i(0,"ag-grid-angular",17),b(1,"async"),b(2,"async"),c("gridReady",function(d){G(e);let l=P();return U(l.gridReady(d))}),r()}if(o&2){let e=P();f("rowData",_(1,7,e.citas))("columnDefs",e.colDefs)("loading",_(2,9,e.isLoading))("localeText",e.localeText)("enableCellTextSelection",!0)("ariaHidden",!0)("pagination",!0)}}function Ae(o,t){o&1&&(i(0,"div",18)(1,"div",19)(2,"span",20),m(3,"Loading..."),r()()())}var ve=class W{constructor(t,e,n,d){this.route=t,this.changeDetector=e,this.router=n,this.citaService=d,this.localeText=ue,this.isLoading=a(M).isLoading,this.theme=a(pe),this.authService=a(te),this.modal=a(C),this.datePipe=a(ee),this.personalService=a(ge),this.citas=new z,this.user=this.authService.user(),this.startWeek=B().startOfWeek,this.endWeek=B().endOfWeek,this.autoSizeStrategy={type:"fitCellContents"},this.colDefs=[{field:"title",headerName:"Paciente",filter:!0,minWidth:250},{field:"tipocita",headerName:"Tipo de Cita",filter:!0},{field:"date",headerName:"Fecha de Cita",valueFormatter:l=>Q(l.value,"dd/MM/yyyy","en"),cellRenderer:l=>(console.log(l),`<span class="d-flex gap-2 align-items-center"><i class="ki-outline ki-calendar text-gray-900 fs-2"></i>${l.valueFormatted}</span>`),filter:"agDateColumnFilter"},{field:"start",headerName:"Hora de Inicio",filter:!0,cellRenderer:l=>`<span class="d-flex gap-2 align-items-center"><i class="ki-outline ki-time text-gray-900 fs-2"></i>${this.datePipe.transform(new Date(l.value),"hh:mm")}</span>`},{field:"end",headerName:"Hora de Fin",filter:!0,cellRenderer:l=>`<span class="d-flex gap-2 align-items-center"><i class="ki-outline ki-time text-gray-900 fs-2"></i>${this.datePipe.transform(new Date(l.value),"hh:mm")}</span>`},{field:"estado",headerName:"Estado",filter:!0,cellRenderer:be},{field:"id",headerName:"Asistencia",filter:!1,resizable:!1,cellRenderer:Ce,cellRendererParams:{openModal:l=>this.openConfirmModal(l)}}]}ngOnInit(){ce("#dateRangePicker",{mode:"range",dateFormat:"Y-m-d",onClose:t=>{if(t.length===2){let[e,n]=t;this.startWeek=e,this.endWeek=n,this.loadCitas()}}}),this.loadCitas()}openConfirmModal(t){let e=this.modal.open(I,{centered:!0,scrollable:!0,backdrop:"static"});e.componentInstance.id_sesion=t,e.componentInstance.citaUpdated.subscribe(()=>{this.loadCitas()})}filtrarCitasPorFechas(t,e){let n=this.user?.personal?.id_personal;n&&(this.citas=this.citaService.getCitasByFecha(n,t,e).pipe(O(d=>d.data),j(d=>S([])),y(this)))}loadCitas(){if(!this.user?.personal)return;let t=this.user?.personal?.id_personal;t?this.citas=this.citaService.getCitasByPersonal({id_personal:t,startWeek:this.startWeek.toISOString(),endWeek:this.endWeek.toISOString()}).pipe(O(e=>e.data),j(e=>S([])),y(this)):this.citas=S([])}gridReady(t){this.gridApi=t.api}sizeColumnsToFit(){let t=()=>this.gridApi.sizeColumnsToFit();new ResizeObserver(()=>{window.innerWidth>=768&&t()}).observe(document.body),t()}static{this.\u0275fac=function(e){return new(e||W)(p(E),p(A),p(R),p(v))}}static{this.\u0275cmp=u({type:W,selectors:[["app-dashboard"]],standalone:!0,features:[g],decls:24,vars:3,consts:[["header-title",""],[1,"d-flex","text-gray-900","fw-bold","align-items-center","gap-2"],[1,"ki-duotone","ki-calendar","text-white","fs-2tx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"",2,"color","white"],[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],[1,"card","shadow","p-2","px-4"],[1,"d-flex","py-4","justify-content-between","align-items-center"],[1,"d-flex","gap-3","w-100"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2"],["id","dateRangePicker","placeholder","Selecciona un rango de Fechas",1,"btn","btn-sm","btn-light","d-flex","ms-auto","px-4"],[2,"height","calc(100dvh - 281px)",3,"ngClass"],["loadingMessage","Cargando...",2,"width","100%","height","100%",3,"gridReady","rowData","columnDefs","loading","localeText","enableCellTextSelection","ariaHidden","pagination"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100%"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(e,n){e&1&&(i(0,"app-header"),$(1,0),i(2,"h1",1)(3,"i",2),s(4,"span",3)(5,"span",4),r(),i(6,"span",5),m(7,"Citas de esta semana"),r()(),Y(),r(),i(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"button",11),c("click",function(){return n.loadCitas()}),i(14,"span",12),s(15,"span",13),i(16,"span",14),m(17,"Actualizar"),r()()(),s(18,"input",15),r()(),i(19,"div",16),D(20,De,3,11)(21,Ae,4,0),H(22,20,ke,21),q(),r()()()()),e&2&&(h(19),f("ngClass",K(1,Se,n.theme.getThemeMode()==="light"?"ag-theme-quartz":"ag-theme-quartz-dark")))},dependencies:[w,X,fe]})}};ve=x([N({checkProperties:!0}),k("design:paramtypes",[E,A,R,v])],ve);export{ve as DashboardComponent};
