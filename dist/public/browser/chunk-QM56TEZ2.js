import{a as oe}from"./chunk-B5OQQ6JI.js";import{a as ie,b as ne}from"./chunk-KG3B2A6X.js";import{a as te}from"./chunk-U2EAJGNN.js";import{o as x,t as Z,u as ee}from"./chunk-AAYOZ3JU.js";import{a as I}from"./chunk-NMGGHNE5.js";import{a as z}from"./chunk-BIMAMPZW.js";import{a as Y}from"./chunk-KNEUCQQI.js";import"./chunk-GKZUPR7X.js";import{B as K,E as Q,L as W,N as X,q as P,r as E,s as U,t as $,y as H,z as J}from"./chunk-ZM3MROS5.js";import{n as V,o as b,t as S,v as y}from"./chunk-DP3M2V7L.js";import{Aa as h,Ac as G,C as w,Gc as _,Ka as L,La as N,Lb as f,Nc as v,Oc as g,Ta as q,Ub as u,bc as e,cc as t,dc as m,ec as B,fc as D,hc as O,n as T,nc as p,oc as j,pb as A,rc as C,v as M,vb as d,wa as c,wb as R,yc as o,zc as k}from"./chunk-B7JMKZ3I.js";function de(a,l){a&1&&(e(0,"div")(1,"small",19),o(2,"La cantidad debe ser mayor que 0."),t()())}function me(a,l){a&1&&m(0,"span",20)}var re=(()=>{class a{constructor(i){this.fb=i,this.modal=c(x),this.loadingService=c(I),this.authService=c(z),this.solicitudInventarioService=c(Z),this.isLoading=this.loadingService.isLoading,this.user=this.authService.user(),this.onRequestComplete=new q,this.solicitarForm=this.fb.group({cantidad_solicitar:["",[E.required,E.min(1)]]})}close(){this.modal.dismissAll()}sendRequest(){if(this.solicitarForm.invalid){console.error("El formulario no es v\xE1lido.");return}let i=this.solicitarForm.get("cantidad_solicitar")?.value,s=this.user?.personal?.id_personal,n=this.user?.personal?.terapia?.id_terapia;if(this.inventarioId===void 0){console.error("inventarioId no est\xE1 definido.");return}if(!s){console.error("No se encontr\xF3 el id_personal del usuario logueado.");return}if(!n){console.error("No se encontr\xF3 el id_terapia del usuario logueado.");return}this.loadingService.startLoading(),this.solicitudInventarioService.enviarSolicitud(s,this.inventarioId.toString(),i,n).subscribe({next:()=>{console.log("Solicitud de stock enviada exitosamente."),this.onRequestComplete.emit()},error:r=>{console.error("Error al enviar la solicitud:",r)},complete:()=>{this.loadingService.stopLoading(),this.close()}})}static{this.\u0275fac=function(s){return new(s||a)(R(W))}}static{this.\u0275cmp=h({type:a,selectors:[["app-solicitar-modal"]],inputs:{inventarioId:"inventarioId"},outputs:{onRequestComplete:"onRequestComplete"},standalone:!0,features:[_],decls:27,vars:8,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-add-files","text-gray-900","fs-1",2,"vertical-align","text-top"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"ngSubmit","formGroup"],[1,"form-group"],["for","cantidad_solicitar",1,"form-label"],["id","cantidad_solicitar","formControlName","cantidad_solicitar","type","number","placeholder","Ingresa la cantidad",1,"form-control"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(s,n){if(s&1&&(e(0,"div",0)(1,"h4",1)(2,"span",2)(3,"i",3),m(4,"span",4)(5,"span",5)(6,"span",6),t()(),o(7," Solicitar Stock "),t(),e(8,"button",7),p("click",function(){return n.close()}),e(9,"i",8),m(10,"span",4)(11,"span",5),t()()(),e(12,"div",9)(13,"form",10),p("ngSubmit",function(){return n.sendRequest()}),e(14,"div",11)(15,"label",12),o(16,"Cantidad a Solicitar"),t(),m(17,"input",13),f(18,de,3,0,"div",14),t()()(),e(19,"div",15)(20,"button",16),p("click",function(){return n.close()}),o(21,"Cancelar"),t(),e(22,"button",17),v(23,"async"),p("click",function(){return n.sendRequest()}),o(24," Enviar solicitud "),f(25,me,1,0,"span",18),v(26,"async"),t()()),s&2){let r;d(13),u("formGroup",n.solicitarForm),d(5),u("ngIf",((r=n.solicitarForm.get("cantidad_solicitar"))==null?null:r.invalid)&&(((r=n.solicitarForm.get("cantidad_solicitar"))==null?null:r.touched)||((r=n.solicitarForm.get("cantidad_solicitar"))==null?null:r.dirty))),d(4),u("disabled",n.solicitarForm.invalid||g(23,4,n.isLoading)),d(3),u("ngIf",g(26,6,n.isLoading))}},dependencies:[X,H,P,J,U,$,K,Q,y,b,S]})}}return a})();function ce(a,l){a&1&&(e(0,"div",20)(1,"div",21)(2,"span",22),o(3,"Cargando..."),t()()())}function pe(a,l){if(a&1){let i=O();e(0,"div",23)(1,"div",24)(2,"div",25),m(3,"img",26),t(),e(4,"div",27)(5,"h5",28),o(6),t(),e(7,"p",29),o(8),t(),e(9,"p",29)(10,"strong"),o(11,"Stock:"),t(),o(12),t(),e(13,"button",30),p("click",function(){let n=L(i).$implicit,r=j();return N(r.openSolicitarModal(n))}),m(14,"span",31),o(15," Solicitar "),t()()()()}if(a&2){let i=l.$implicit;d(3),C("src",i.banner_url,A),C("alt",i.nombre),d(3),k(i.nombre),d(2),k(i.descripcion),d(4),G(" ",i.stock,"")}}var ae=class F{constructor(){this.inventarioService=c(oe),this.isLoading=c(I).isLoading,this.theme=c(Y),this.modal=c(x),this.inventarioList=new T,this.localeText=te}ngOnInit(){this.fetchInventario()}fetchInventario(){this.inventarioList=this.inventarioService.getAll().pipe(w(l=>(console.log("Inventario recibido:",l.data),l.data)),ne(this))}loadTabla(){this.fetchInventario()}gridReady(l){this.gridApi=l.api}onFilterTextBoxChanged(){this.gridApi.setGridOption("quickFilterText",document.getElementById("item-search").value)}openSolicitarModal(l){let i=this.modal.open(re,{size:"300px",animation:!0,centered:!0});i.componentInstance.inventarioId=l.id,i.componentInstance.onRequestComplete.subscribe(()=>{this.fetchInventario()})}ngOnDestroy(){}static{this.\u0275fac=function(i){return new(i||F)}}static{this.\u0275cmp=h({type:F,selectors:[["app-inventario"]],standalone:!0,features:[_],decls:25,vars:6,consts:[["header-title",""],[1,"d-flex","flex-column","text-gray-900","fw-bold","my-1"],[1,"",2,"color","white"],[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],[1,"d-flex","py-4","justify-content-between","align-items-center"],["data-kt-search-element","form","autocomplete","off",1,"position-relative"],["type","hidden"],[1,"ki-duotone","ki-magnifier","fs-2","search-icon","position-absolute","top-50","translate-middle-y","ms-4"],[1,"path1"],[1,"path2"],["type","search","id","item-search","name","search","placeholder","B\xFAsqueda","data-kt-search-element","input",1,"form-control","custom-form-control","ps-13",3,"input"],[1,"d-flex","align-items-center","gap-3"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2"],["class","loading-container d-flex justify-content-center align-items-center",4,"ngIf"],[1,"row"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"loading-container","d-flex","justify-content-center","align-items-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"col-md-4"],[1,"card","mb-4",2,"width","18rem","padding","5px"],[1,"image-container",2,"box-shadow","0 4px 8px rgba(0, 0, 0, 0.1)","border-radius","8px","overflow","hidden"],[1,"card-img-top",2,"width","100%","height","auto",3,"src","alt"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["type","button",1,"btn","btn-primary","btn-lg","w-100","d-flex","justify-content-center","align-items-center",3,"click"],[1,"ki-solid","ki-plus","text-white","fs-1"]],template:function(i,s){i&1&&(e(0,"app-header"),B(1,0),e(2,"h1",1)(3,"span",2),o(4,"Inventario"),t()(),D(),t(),e(5,"div",3)(6,"div",4)(7,"div",5)(8,"form",6),m(9,"input",7),e(10,"i",8),m(11,"span",9)(12,"span",10),t(),e(13,"input",11),p("input",function(){return s.onFilterTextBoxChanged()}),t()(),e(14,"div",12)(15,"button",13),p("click",function(){return s.loadTabla()}),e(16,"span",14),m(17,"span",15),e(18,"span",16),o(19,"Actualizar"),t()()()()(),f(20,ce,4,0,"div",17),v(21,"async"),e(22,"div",18),f(23,pe,16,5,"div",19),v(24,"async"),t()()()),i&2&&(d(20),u("ngIf",g(21,2,s.isLoading)),d(3),u("ngForOf",g(24,4,s.inventarioList)))},dependencies:[y,V,b,S,ee]})}};ae=M([ie()],ae);export{ae as InventarioComponent};
