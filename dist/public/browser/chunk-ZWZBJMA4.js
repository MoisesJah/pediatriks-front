import{a as N,b as $,c as j,d as q,e as z}from"./chunk-FJOUAKUW.js";import{a as u}from"./chunk-7YUY65AQ.js";import{ib as Z,jb as J,lb as X}from"./chunk-LCUQXNNV.js";import"./chunk-L62UVQQZ.js";import{a as K}from"./chunk-U3X3T6AK.js";import"./chunk-T5EURV5D.js";import{a as U}from"./chunk-VIK6P75G.js";import"./chunk-GULRCE2W.js";import"./chunk-WFL7FBLQ.js";import"./chunk-56DO2HCL.js";import"./chunk-4BKNE7VM.js";import"./chunk-GT4JH6HJ.js";import"./chunk-EBZKSOFQ.js";import{c as H}from"./chunk-HC5HCKLL.js";import{a as B}from"./chunk-4JVWF6E6.js";import{o as Q}from"./chunk-47BWZHPK.js";import"./chunk-JV7DKPVM.js";import{a as R}from"./chunk-MKNMNAUM.js";import{a as V,b as c}from"./chunk-TA6YOJTR.js";import"./chunk-T5KXAZJZ.js";import"./chunk-GKZUPR7X.js";import{l as A}from"./chunk-P5QLGDHL.js";import{m as T,t as G,w as O}from"./chunk-CWIGPBJP.js";import{Ba as b,Bc as M,C as s,Cc as D,Dc as I,Fc as d,Mb as x,Qb as S,Qc as F,Sc as L,Tb as k,Vb as w,Xc as m,Yc as p,a as v,b as C,fc as r,gc as a,hc as _,ic as P,jc as W,ka as l,n as y,v as g,vc as E,xa as n}from"./chunk-JCDSCFF6.js";var ee=["calendar"],te=()=>[Z,T,G],ie=o=>({"opacity-50":o});function ne(o,e){if(o&1&&(_(0,"full-calendar",8,0),m(2,"async"),m(3,"async")),o&2){let t=E();w("events",p(2,3,t.citasEvent))("ngClass",L(7,ie,p(3,5,t.isLoading)))("options",t.calendarOptions)}}function oe(o,e){o&1&&(r(0,"h1"),d(1,"Loading..."),a())}var Y=class f{constructor(){this.isLoading=n(R).isLoading,this.modalService=n(Q),this.loadingCalendar=!1,this.citasService=n(K),this.userService=n(B),this.personalService=n(U),this.router=n(A),this.citasEvent=new y,this.personalId="",this.startWeek=u().startOfWeek,this.endWeek=u().endOfWeek,this.calendarOptions={plugins:[N,$,j,q],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},eventMaxStack:1,allDaySlot:!1,expandRows:!0,slotLabelInterval:"00:05:00",slotMinTime:"08:00",slotMaxTime:"20:00:00",slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:!1,meridiem:"narrow"},eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},selectConstraint:"businessHours",initialView:"timeGridWeek",weekends:!0,editable:!0,loading:e=>{this.loadingCalendar=e},eventClick:this.handleEventClick.bind(this),selectAllow:e=>{let t=this.calendar?.getApi()?.view.type=="timeGridWeek",i=new Date;return i.setHours(0,0,0,0),e.start>=i&&t},selectable:!1,selectMirror:!0,dayMaxEvents:!0,locale:z,displayEventTime:!1,eventDidMount:e=>{},datesSet:e=>{this.startWeek=e.view.activeStart,this.endWeek=e.view.activeEnd,this.loadCitas(this.bodyParams)}}}ngOnInit(){this.getPersonalId()}get bodyParams(){return{id_personal:this.personalId,startWeek:this.startWeek,endWeek:this.endWeek}}getPersonalId(){this.personalService.getPersonalByUser(this.userService.user()?.id).pipe(s(e=>e.data.id_personal),l(e=>this.personalId=e),l(()=>this.loadCitas(this.bodyParams)),c(this)).subscribe()}loadCitas(e){if(this.personalId)return this.citasEvent=this.citasService.getByPersonal(e).pipe(s(t=>t.data.map(i=>C(v({},i),{title:`${i.tipocita} - ${i.title}`}))),c(this))}handleEventClick(e){let t=e.event,i=this.modalService.open(X,{centered:!0,size:"100",scrollable:!0,backdrop:"static"});window.document.body.classList.add("modal-open"),i.componentInstance.eventId=t.id,i.componentInstance.citaId=t.extendedProps.id_cita,i.componentInstance.eventUpdated.subscribe(()=>{this.loadCitas(this.bodyParams)})}static{this.\u0275fac=function(t){return new(t||f)}}static{this.\u0275cmp=b({type:f,selectors:[["app-citas"]],viewQuery:function(t,i){if(t&1&&M(ee,5),t&2){let h;D(h=I())&&(i.calendar=h.first)}},standalone:!0,features:[F],decls:13,vars:0,consts:[["calendar",""],["header-title",""],[1,"d-flex","align-items-center","text-white","fw-bold","my-1"],[1,"content","d-flex","flex-column","flex-column-fluid"],["id","kt_content_container",1,"container-xxl"],[1,"card"],[1,"card-body",2,"border","none","box-shadow","0 4px 8px rgba(0, 0, 0, 0.1)","border-radius","0 0 15px 15px"],[1,"demo-app-main"],[3,"events","ngClass","options"]],template:function(t,i){t&1&&(r(0,"app-header"),P(1,1),r(2,"h1",2),d(3," Calendario de Citas "),a(),W(),a(),r(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),x(9,ne,4,9)(10,oe,2,0),S(11,9,te,null,10),k(0,-1),a()()()()())},dependencies:[H,J,O]})}};Y=g([V()],Y);export{Y as CitasComponent};
