import{a as F}from"./chunk-4VMHRPQE.js";import{a as ue}from"./chunk-E6U7EDCE.js";import{a as Ve}from"./chunk-N3446XRF.js";import{a as Le}from"./chunk-74A4TY7I.js";import{c as W,d as Y}from"./chunk-E2DR7QOK.js";import{a as Ne,b as Te}from"./chunk-NQFS4EYQ.js";import{a as K}from"./chunk-GT4JH6HJ.js";import{a as we}from"./chunk-MYRVSVX3.js";import{a as B,b as R}from"./chunk-MN65TUXJ.js";import{a as k}from"./chunk-IYBN42Q7.js";import{b as E,g as ae,i as De,j as Me}from"./chunk-AQJAMIXE.js";import{e as X,f as s,g as U,h as Z,k as Pe,l as ee,m as te,o as ie,r as ne,s as re,u as V,v as xe,w as A}from"./chunk-YR44ZVP5.js";import{c as ce,e as Ie,g as L,j as C,l as S}from"./chunk-EITZOAMY.js";import{Ab as ve,B as w,C as j,Cb as qe,Da as g,Fb as f,I as N,Ma as q,Na as y,Ob as r,Pb as i,Qb as o,Rb as ye,Sb as _e,Ua as T,Ub as G,Zb as d,_b as de,a as fe,b as he,bc as Ce,dc as Q,eb as ge,ec as z,f as be,fc as $,hc as l,jb as u,kb as J,lc as Se,mc as Ee,nc as ke,pc as v,rc as Fe,t as M,vc as h,wb as _,wc as b,za as c}from"./chunk-LYSYPXVF.js";var oe=be(Ve());var ze=["datePicker"],$e=["endDatePicker"];function Ue(m,e){m&1&&o(0,"span",40)}var I,le=(I=class{constructor(e){this.fb=e,this.modal=c(E),this.paqueteService=c(F),this.loadingService=c(k),this.terapiaService=c(ae),this.isLoading=this.loadingService.isLoading,this.terapiaid="",this.terapiasList=new M,this.onSaveComplete=new T,this.paqueteForm=this.fb.group({nombre:["",s.required],descripcion:[""],cantidadsesiones:["",[s.required,s.min(1)]],precioregular:["",[s.required,s.min(0),s.pattern("^[0-9]+(\\.[0-9]{1,2})?$")]],descuento:["",[s.required,s.min(0),s.max(100),s.pattern("^[0-9]+(\\.[0-9]{1,2})?$")]],preciopaquete:["",[s.required,s.min(0),s.pattern("^[0-9]+(\\.[0-9]{1,2})?$")]],fechainicio:["",s.required],fechafin:["",s.required],terapias:[null,s.required],banner_url:[""]})}evtSelectFile(e){let n=e.target.files;this.paqueteForm.get("banner_url")?.setValue(n?.item(0))}ngOnInit(){this.loadTerapias(),this.paqueteForm.get("precioregular")?.valueChanges.subscribe(()=>this.calculatePreciopaquete()),this.paqueteForm.get("descuento")?.valueChanges.subscribe(()=>this.calculatePreciopaquete()),this.paqueteForm.get("fechainicio")?.valueChanges.subscribe(()=>{this.paqueteForm.get("fechafin")?.value<this.paqueteForm.get("fechainicio")?.value&&this.paqueteForm.get("fechafin")?.setValue(this.paqueteForm.get("fechainicio")?.value)})}loadTerapias(){this.terapiasList=this.terapiaService.getAll().pipe(N(e=>e.data),R(this))}ngAfterViewInit(){let e=new Date;this.datePicker&&this.datePicker.nativeElement&&K(this.datePicker.nativeElement,{locale:oe.Spanish,altFormat:"d/m/Y",altInput:!0,minDate:e,onChange:n=>{let t=n[0];if(this.endDatePicker&&this.endDatePicker.nativeElement){let a=K(this.endDatePicker.nativeElement,{locale:oe.Spanish,altFormat:"d/m/Y",altInput:!0,minDate:t});this.paqueteForm.get("fechafin")?.value<t&&(this.paqueteForm.get("fechafin")?.setValue(t),a.setDate(t))}}}),this.endDatePicker&&this.endDatePicker.nativeElement&&K(this.endDatePicker.nativeElement,{locale:oe.Spanish,altInput:!0,altFormat:"d/m/Y",minDate:e})}close(){this.modal.dismissAll()}save(){let e=new FormData;Object.keys(this.paqueteForm.value).forEach(n=>{let t=this.paqueteForm.get(n);Array.isArray(t?.value)?e.append(n,JSON.stringify(t?.value)):e.append(n,t?.value)}),this.paqueteService.create(e).subscribe({next:()=>{this.modal.dismissAll(),this.onSaveComplete.emit()},error:n=>{console.log(n)}})}calculatePreciopaquete(){let e=this.paqueteForm.get("precioregular")?.value,n=this.paqueteForm.get("descuento")?.value;if(e&&n!=null){let t=n/100,a=e-e*t;this.paqueteForm.get("preciopaquete")?.setValue(a.toFixed(2),{emitEvent:!1})}}},I.\u0275fac=function(n){return new(n||I)(J(V))},I.\u0275cmp=g({type:I,selectors:[["app-crear-modal"]],viewQuery:function(n,t){if(n&1&&(Q(ze,5),Q($e,5)),n&2){let a;z(a=$())&&(t.datePicker=a.first),z(a=$())&&(t.endDatePicker=a.first)}},inputs:{terapiaid:"terapiaid"},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[v],decls:68,vars:14,consts:[["datePicker",""],["endDatePicker",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-add-files","text-gray-900","fs-1",2,"vertical-align","text-top"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"formGroup"],[1,"form-group"],["for","nombre",1,"required","form-label"],["type","text","id","nombre","formControlName","nombre","placeholder","Ingresa Nombre del Paquete",1,"form-control"],["for","",1,"required","form-label"],["type","file","id","imagen","accept","image/*",1,"form-control",3,"change"],["for","descripcion",1,"form-label"],["cols","3","rows","2","id","descripcion","formControlName","descripcion","placeholder","Ingresa Descripci\xF3n del Paquete",1,"form-control"],["for","terapias",1,"required","form-label"],["bindValue","id_terapia","bindLabel","nombre","formControlName","terapias","placeholder","Seleccionar","bindLabel","nombre",3,"items","multiple","closeOnSelect","hideSelected","loadingText"],[1,"row"],[1,"form-group","col-6"],["for","cantidadsesiones",1,"required","form-label"],["type","number","id","cantidadsesiones","formControlName","cantidadsesiones","min","1","placeholder","Nro de Sesiones",1,"form-control"],["for","precioregular",1,"required","form-label"],["type","number","id","precioregular","formControlName","precioregular","min","0","step","0.01","placeholder","Ingresar Precio",1,"form-control"],["for","descuento",1,"required","form-label"],["type","number","id","descuento","formControlName","descuento","min","0","step","0.01","placeholder","Ingresar Descuento %",1,"form-control"],["for","preciopaquete",1,"required","form-label"],["type","number","id","preciopaquete","formControlName","preciopaquete","min","0","step","0.01","placeholder","Precio Total",1,"form-control"],["for","fechainicio",1,"required","form-label"],["type","text","id","kt_calendar_datepicker_date","formControlName","fechainicio","placeholder","Seleccionar Fecha",1,"form-control"],["for","fechafin",1,"required","form-label"],["type","text","id","kt_calendar_datepicker_end_date","formControlName","fechafin","placeholder","Seleccionar Fecha",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(n,t){if(n&1){let a=G();r(0,"div",2)(1,"h4",3)(2,"span",4)(3,"i",5),o(4,"span",6)(5,"span",7)(6,"span",8),i()(),l(7," A\xF1adir Paquete "),i(),r(8,"button",9),d("click",function(){return q(a),y(t.close())}),r(9,"i",10),o(10,"span",6)(11,"span",7),i()()(),r(12,"div",11)(13,"form",12)(14,"div",13)(15,"label",14),l(16,"Nombre del Paquete"),i(),o(17,"input",15),i(),r(18,"div",13)(19,"label",16),l(20,"Imagen"),i(),r(21,"input",17),d("change",function(O){return q(a),y(t.evtSelectFile(O))}),i()(),r(22,"div",13)(23,"label",18),l(24,"Descripci\xF3n"),i(),o(25,"textarea",19),i(),r(26,"div",13)(27,"label",20),l(28,"Seleccionar Terapia(s) Incluidas"),i(),o(29,"ng-select",21),h(30,"async"),i(),r(31,"div",22)(32,"div",23)(33,"label",24),l(34,"Cantidad de Sesiones"),i(),o(35,"input",25),i(),r(36,"div",23)(37,"label",26),l(38,"Precio Regular"),i(),o(39,"input",27),i()(),r(40,"div",22)(41,"div",23)(42,"label",28),l(43,"Descuento %"),i(),o(44,"input",29),i(),r(45,"div",23)(46,"label",30),l(47,"Precio del Paquete"),i(),o(48,"input",31),i()(),r(49,"div",22)(50,"div",23)(51,"label",32),l(52,"Fecha de Inicio"),i(),o(53,"input",33,0),i(),r(55,"div",23)(56,"label",34),l(57,"Fecha de Fin"),i(),o(58,"input",35,1),i()()()(),r(60,"div",36)(61,"button",37),d("click",function(){return q(a),y(t.close())}),l(62," Cancelar "),i(),r(63,"button",38),h(64,"async"),d("click",function(){return q(a),y(t.save())}),l(65," Guardar "),_(66,Ue,1,0,"span",39),h(67,"async"),i()()}n&2&&(u(13),f("formGroup",t.paqueteForm),u(16),f("items",b(30,8,t.terapiasList))("multiple",!0)("closeOnSelect",!1)("hideSelected",!0)("loadingText","Cargando.."),u(34),f("disabled",t.paqueteForm.invalid||b(64,10,t.isLoading)),u(3),f("ngIf",b(67,12,t.isLoading)))},dependencies:[A,ee,X,te,U,Z,re,ie,ne,S,L,C,Y,W]}),I);le=w([B({checkProperties:!0}),j("design:paramtypes",[V])],le);function We(m,e){m&1&&o(0,"span",13)}var Re=(()=>{let e=class e{constructor(){this.modal=c(E),this.paqueteService=c(F),this.isLoading=c(k).isLoading,this.paqueteId="",this.onSaveComplete=new T}close(){this.modal.dismissAll()}delete(){let t=typeof this.paqueteId=="string"?this.paqueteId:this.paqueteId.id_paquetes;t?this.paqueteService.delete(t).subscribe({next:()=>{this.onSaveComplete.emit(),this.modal.dismissAll()},error:a=>{console.error("Error al eliminar paquete:",a)}}):console.error("ID del paquete no proporcionado o en formato incorrecto")}};e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=g({type:e,selectors:[["app-borrar-modal"]],inputs:{paqueteId:"paqueteId"},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[v],decls:25,vars:6,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-information","text-danger","fs-2hx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body","text-center"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(a,p){a&1&&(r(0,"div",0)(1,"h4",1)(2,"span")(3,"i",2),o(4,"span",3)(5,"span",4)(6,"span",5),i()(),l(7," Eliminar Paquete "),i(),r(8,"button",6),d("click",function(){return p.close()}),r(9,"i",7),o(10,"span",3)(11,"span",4),i()()(),r(12,"div",8)(13,"p"),l(14,"\xBFEst\xE1s seguro de eliminar este registro de paquete?"),i(),r(15,"p"),l(16,"Toda la informaci\xF3n relacionada con este paquete se perder\xE1."),i()(),r(17,"div",9)(18,"button",10),d("click",function(){return p.close()}),l(19," Cancelar "),i(),r(20,"button",11),h(21,"async"),d("click",function(){return p.delete()}),l(22," Eliminar "),_(23,We,1,0,"span",12),h(24,"async"),i()()),a&2&&(u(20),f("disabled",b(21,2,p.isLoading)),u(3),f("ngIf",b(24,4,p.isLoading)))},dependencies:[A,S,L,C]});let m=e;return m})();var Oe=be(Ve());var Ye=["datePicker"],He=["endDatePicker"];function Je(m,e){m&1&&o(0,"span",36)}var P,me=(P=class{constructor(e){this.fb=e,this.modal=c(E),this.paqueteService=c(F),this.terapiaService=c(ae),this.isLoading=c(k).isLoading,this.paqueteId="",this.es=Oe.default.es,this.terapiasList=new M,this.onSaveComplete=new T,this.paqueteForm=this.fb.group({nombre:["",s.required],descripcion:["",s.required],cantidadsesiones:[0,[s.required,s.min(0)]],precioregular:[0,[s.required,s.min(0)]],descuento:[0,[s.required,s.min(0)]],preciopaquete:[0,[s.required,s.min(0)]],fechainicio:["",s.required],fechafin:["",s.required],terapias:[null,s.required],sesionesrestantes:[0,[s.required,s.min(0)]]})}ngOnInit(){this.loadTerapias(),typeof this.paqueteId=="string"?this.loadPaqueteData():typeof this.paqueteId=="object"&&this.paqueteId.id_paquetes?this.loadPaqueteData(this.paqueteId.id_paquetes):console.error("ID del paquete no proporcionado o no es una cadena",this.paqueteId),this.paqueteForm.get("precioregular")?.valueChanges.subscribe(()=>this.calculatePreciopaquete()),this.paqueteForm.get("descuento")?.valueChanges.subscribe(()=>this.calculatePreciopaquete()),this.paqueteForm.get("fechainicio")?.valueChanges.subscribe(()=>{this.paqueteForm.get("fechafin")?.value<this.paqueteForm.get("fechainicio")?.value&&this.paqueteForm.get("fechafin")?.setValue(this.paqueteForm.get("fechainicio")?.value)})}loadTerapias(){this.terapiasList=this.terapiaService.getAll().pipe(N(e=>e.data),R(this))}close(){this.modal.dismissAll()}save(){if(this.paqueteForm.valid){let e=this.paqueteForm.value;typeof this.paqueteId=="string"?this.paqueteService.update(this.paqueteId,e).subscribe({next:()=>{this.onSaveComplete.emit(),this.modal.dismissAll()},error:n=>{console.error("Error al actualizar paquete:",n.message)}}):typeof this.paqueteId=="object"&&this.paqueteId.id_paquetes?this.paqueteService.update(this.paqueteId.id_paquetes,e).subscribe({next:()=>{this.onSaveComplete.emit(),this.modal.dismissAll()},error:n=>{console.error("Error al actualizar paquete:",n.message)}}):console.error("ID del paquete no proporcionado o en formato incorrecto")}}loadPaqueteData(e){let n=e||(typeof this.paqueteId=="object"?this.paqueteId.id_paquetes:this.paqueteId);n?this.paqueteService.getById(n).subscribe({next:t=>{this.paqueteForm.patchValue(he(fe({},t.data),{terapias:t.data.terapias.map(a=>a.id_terapia)}))},error:t=>{console.error("Error al cargar datos del paquete:",t)}}):console.error("ID del paquete no proporcionado")}calculatePreciopaquete(){let e=this.paqueteForm.get("precioregular")?.value,n=this.paqueteForm.get("descuento")?.value;if(e&&n!=null){let t=n/100,a=e-e*t;this.paqueteForm.get("preciopaquete")?.setValue(a,{emitEvent:!1})}}},P.\u0275fac=function(n){return new(n||P)(J(V))},P.\u0275cmp=g({type:P,selectors:[["app-editar-modal"]],viewQuery:function(n,t){if(n&1&&(Q(Ye,5),Q(He,5)),n&2){let a;z(a=$())&&(t.datePicker=a.first),z(a=$())&&(t.endDatePicker=a.first)}},inputs:{paqueteId:"paqueteId"},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[v],decls:63,vars:22,consts:[["datePicker",""],["endDatePicker",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-notepad-edit","text-gray-900","fs-1",2,"vertical-align","top"],[1,"path1"],[1,"path2"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"formGroup"],[1,"form-group"],["for","nombre",1,"required","form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],["for","descripcion",1,"required","form-label"],["rows","2","id","descripcion","formControlName","descripcion",1,"form-control"],["for","terapias",1,"required","form-label"],["bindValue","id_terapia","bindLabel","nombre","formControlName","terapias","placeholder","Seleccionar","bindLabel","nombre",3,"items","multiple","closeOnSelect","hideSelected","loadingText"],[1,"row"],[1,"form-group","col-6"],["for","cantidadsesiones",1,"required","form-label"],["type","number","id","cantidadsesiones","formControlName","cantidadsesiones","min","1",1,"form-control"],["for","precioregular",1,"required","form-label"],["type","number","id","precioregular","formControlName","precioregular","min","0","step","0.01",1,"form-control"],["for","descuento",1,"required","form-label"],["type","number","id","descuento","formControlName","descuento","min","0","step","0.01",1,"form-control"],["for","preciopaquete",1,"required","form-label"],["type","number","id","preciopaquete","formControlName","preciopaquete","min","0","step","0.01",1,"form-control"],["for","fechainicio",1,"required","form-label"],["id","kt_calendar_datepicker_date","mwlFlatpickr","","formControlName","fechainicio","placeholder","Seleccionar Fecha",1,"form-control",3,"locale","altInput","altFormat","monthSelectorType"],["for","fechafin",1,"required","form-label"],["id","kt_calendar_datepicker_end_date","formControlName","fechafin","mwlFlatpickr","","placeholder","Seleccionar Fecha",1,"form-control",3,"locale","altInput","altFormat","monthSelectorType"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(n,t){if(n&1){let a=G();r(0,"div",2)(1,"h4",3)(2,"span")(3,"i",4),o(4,"span",5)(5,"span",6),i()(),l(6," Editar Paquete "),i(),r(7,"button",7),d("click",function(){return q(a),y(t.close())}),r(8,"i",8),o(9,"span",5)(10,"span",6),i()()(),r(11,"div",9)(12,"form",10)(13,"div",11)(14,"label",12),l(15,"Nombre del Paquete"),i(),o(16,"input",13),i(),r(17,"div",11)(18,"label",14),l(19,"Descripci\xF3n"),i(),o(20,"textarea",15),i(),r(21,"div",11)(22,"label",16),l(23,"Seleccionar Terapia(s) Incluidas"),i(),o(24,"ng-select",17),h(25,"async"),i(),r(26,"div",18)(27,"div",19)(28,"label",20),l(29,"Cantidad de Sesiones"),i(),o(30,"input",21),i(),r(31,"div",19)(32,"label",22),l(33,"Precio Regular"),i(),o(34,"input",23),i()(),r(35,"div",18)(36,"div",19)(37,"label",24),l(38,"Descuento %"),i(),o(39,"input",25),i(),r(40,"div",19)(41,"label",26),l(42,"Precio del Paquete"),i(),o(43,"input",27),i()(),r(44,"div",18)(45,"div",19)(46,"label",28),l(47,"Fecha de Inicio"),i(),o(48,"input",29,0),i(),r(50,"div",19)(51,"label",30),l(52,"Fecha de Fin"),i(),o(53,"input",31,1),i()()()(),r(55,"div",32)(56,"button",33),d("click",function(){return q(a),y(t.close())}),l(57," Cancelar "),i(),r(58,"button",34),h(59,"async"),d("click",function(){return q(a),y(t.save())}),l(60," Guardar "),_(61,Je,1,0,"span",35),h(62,"async"),i()()}n&2&&(u(12),f("formGroup",t.paqueteForm),u(12),f("items",b(25,16,t.terapiasList))("multiple",!0)("closeOnSelect",!1)("hideSelected",!0)("loadingText","Cargando.."),u(24),f("locale",t.es)("altInput",!0)("altFormat","d/m/Y")("monthSelectorType","dropdown"),u(5),f("locale",t.es)("altInput",!0)("altFormat","d/m/Y")("monthSelectorType","dropdown"),u(5),f("disabled",t.paqueteForm.invalid||b(59,18,t.isLoading)),u(3),f("ngIf",b(62,20,t.isLoading)))},dependencies:[A,ee,X,te,U,Z,re,ie,ne,S,L,C,Te,Ne,Y,W]}),P);me=w([B({checkProperties:!0}),j("design:paramtypes",[V])],me);function Ke(m,e){m&1&&(r(0,"div",15),l(1," No hay pacientes disponibles para seleccionar. "),i())}function Xe(m,e){m&1&&o(0,"span",16)}var x,pe=(x=class{constructor(){this.modal=c(E),this.paqueteService=c(F),this.pacienteService=c(Le),this.isLoading$=c(k).isLoading,this.paqueteId="",this.onSaveComplete=new T,this.pacientesList=new M,this.selectedPatient=null,this.isLoading=!1,this.fetchPacientes(),this.subscription=this.isLoading$.subscribe(e=>{this.isLoading=e})}get isPurchaseDisabled(){return this.isLoading||!this.selectedPatient}fetchPacientes(){this.pacientesList=this.pacienteService.getAll().pipe(R(this),N(e=>e.data||[]))}close(){this.modal.dismissAll(),this.subscription.unsubscribe()}purchase(){let e=typeof this.paqueteId=="string"?this.paqueteId:this.paqueteId.id_paquete;e&&this.selectedPatient?this.paqueteService.purchase(e,this.selectedPatient).subscribe({next:()=>{this.onSaveComplete.emit(),this.modal.dismissAll()},error:n=>{console.error("Error al comprar paquete:",n)}}):console.error("ID del paquete o paciente no proporcionados")}},x.\u0275fac=function(n){return new(n||x)},x.\u0275cmp=g({type:x,selectors:[["app-comprar-modal"]],inputs:{paqueteId:"paqueteId"},outputs:{onSaveComplete:"onSaveComplete"},standalone:!0,features:[v],decls:30,vars:16,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"ki-duotone","ki-handcart","text-white","me-2","fs-2hx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body","text-center"],["bindLabel","nombre","bindValue","id_paciente","placeholder","Selecciona un paciente",3,"ngModelChange","ngModel","items","disabled"],["class","mt-3 text-danger",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"mt-3","text-danger"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(n,t){if(n&1&&(r(0,"div",0)(1,"h4",1)(2,"span")(3,"i",2),o(4,"span",3)(5,"span",4)(6,"span",5),i()(),l(7," Adquirir Paquete "),i(),r(8,"button",6),d("click",function(){return t.close()}),r(9,"i",7),o(10,"span",3)(11,"span",4),i()()(),r(12,"div",8)(13,"p"),l(14,"\xBFEst\xE1s seguro de comprar este Paquete?"),i(),r(15,"p"),l(16,"Selecciona el paciente que desees para continuar con la compra."),i(),r(17,"ng-select",9),h(18,"async"),h(19,"async"),ke("ngModelChange",function(p){return Ee(t.selectedPatient,p)||(t.selectedPatient=p),p}),i(),_(20,Ke,2,0,"div",10),h(21,"async"),i(),r(22,"div",11)(23,"button",12),d("click",function(){return t.close()}),l(24," Cancelar "),i(),r(25,"button",13),h(26,"async"),d("click",function(){return t.purchase()}),l(27," Comprar "),_(28,Xe,1,0,"span",14),h(29,"async"),i()()),n&2){let a,p;u(17),Se("ngModel",t.selectedPatient),f("items",b(18,6,t.pacientesList))("disabled",((a=b(19,8,t.pacientesList))==null?null:a.length)===0),u(3),f("ngIf",((p=b(21,10,t.pacientesList))==null?null:p.length)===0),u(5),f("disabled",b(26,12,t.isLoading$)||!t.selectedPatient),u(3),f("ngIf",b(29,14,t.isLoading$))}},dependencies:[A,U,xe,Pe,S,L,C,Y,W]}),x);pe=w([B({checkProperties:!0}),j("design:paramtypes",[])],pe);var je=(()=>{let e=class e{ngOnInit(){}agInit(t){this.params=t}openEdit(){this.params?.onEdit(this.params.data)}openDelete(){this.params?.onDelete(this.params.data)}refresh(t){return!0}};e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=g({type:e,selectors:[["app-paquete-action-buttons"]],decls:5,vars:0,consts:[[1,"d-flex","align-items-center","gap-2",2,"padding-block","0.15rem"],["type","button",1,"btn","btn-icon","btn-sm","bg-success",3,"click"],[1,"ki-solid","ki-pencil","text-white"],["type","button",1,"btn","btn-icon","btn-sm","btn-danger",3,"click"],[1,"ki-solid","ki-trash","text-white"]],template:function(a,p){a&1&&(r(0,"div",0)(1,"button",1),d("click",function(){return p.openEdit()}),o(2,"span",2),i(),r(3,"button",3),d("click",function(){return p.openDelete()}),o(4,"span",4),i()())}});let m=e;return m})();var Ge=(()=>{let e=class e{constructor(){this.image=null}ngOnInit(){}agInit(t){this.params=t,t.value&&(this.image=t.data.banner_url)}refresh(t){return!0}};e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=g({type:e,selectors:[["app-image-display"]],standalone:!0,features:[v],decls:2,vars:1,consts:[[1,"my-2"],["alt","imagen del paquete",1,"img-fluid","w-100px","rounded-1",3,"src"]],template:function(a,p){a&1&&(r(0,"div",0),o(1,"img",1),i()),a&2&&(u(),Ce("src",p.image,ge))}});let m=e;return m})();var Ze=()=>[C,import("./chunk-FR6WE26R.js").then(m=>m.AgGridAngular)],et=m=>[m];function tt(m,e){if(m&1){let n=G();r(0,"ag-grid-angular",22),h(1,"async"),h(2,"async"),d("gridReady",function(a){q(n);let p=de();return y(p.gridReady(a))}),i()}if(m&2){let n=de();f("rowData",b(1,6,n.paquetesList))("localeText",n.localeText)("columnDefs",n.colDefs)("pagination",!0)("enableCellTextSelection",!0)("loading",b(2,8,n.isLoading))}}var D,Qe=(D=class{constructor(){this.paquetesService=c(F),this.isLoading=c(k).isLoading,this.theme=c(De),this.modal=c(E),this.paquetesList=new M,this.localeText=we,this.colDefs=[{field:"banner_url",headerName:"Imagen",cellRendererSelector:e=>e.value?{component:Ge,params:e.data.banner_url}:void 0},{field:"nombre",headerName:"Nombre",filter:!0},{field:"descripcion",headerName:"Descripcion"},{field:"terapias",headerName:"Terapias Incluidas",filter:!0,filterValueGetter:e=>e.data.terapias.map(t=>t.nombre).join(", "),valueFormatter:e=>e.data.terapias.map(t=>t.nombre).join(", "),cellRenderer:e=>`<ul>${e.data.terapias.map(t=>`<li>${t.nombre}</li>`).join("")}</ul>`,autoHeight:!0},{field:"cantidadsesiones",headerName:"N\xB0 de Sesiones",maxWidth:150,filter:"agNumberColumnFilter"},{field:"precioregular",headerName:"Precio Regular",valueFormatter:e=>ue(e.value)},{field:"descuento",headerName:"Descuento",valueFormatter:e=>`${e.value}%`},{field:"preciopaquete",headerName:"Precio del Paquete",valueFormatter:e=>ue(e.value)},{field:"fechainicio",headerName:"Fecha de Inicio",filter:"agDateColumnFilter",valueFormatter:e=>ce(e.value,"dd/MM/yyyy","en")},{field:"fechafin",headerName:"Fecha de Fin",filter:"agDateColumnFilter",valueFormatter:e=>ce(e.value,"dd/MM/yyyy","en")},{headerName:"Acciones",cellRenderer:je,cellRendererParams:{onEdit:e=>this.openEditarModal(e),onDelete:e=>this.openBorrarModal(e)},maxWidth:100,resizable:!1}]}ngOnInit(){this.fetchPaquetes()}fetchPaquetes(){this.paquetesList=this.paquetesService.getAll().pipe(N(e=>(console.log("Paquetes recibidos:",e.data),e.data)),R(this))}loadTabla(){this.fetchPaquetes()}gridReady(e){this.gridApi=e.api}onFilterTextBoxChanged(){this.gridApi.setGridOption("quickFilterText",document.getElementById("paquete-search").value)}openCrearModal(){this.modal.open(le,{size:"350px",animation:!0,centered:!0}).componentInstance.onSaveComplete.subscribe(()=>{this.fetchPaquetes()})}getTerapiasNombres(e){return e.map(n=>n.nombre).join(", ")}openEditarModal(e){let n=this.modal.open(me);n.componentInstance.paqueteId=e.id_paquetes,n.componentInstance.onSaveComplete.subscribe(()=>{this.fetchPaquetes()})}openBorrarModal(e){if(!e.id_paquetes){console.error("El paquete no tiene un id_paquete definido.");return}let n=this.modal.open(Re,{size:"300px",animation:!0,centered:!0});n.componentInstance.paqueteId=e.id_paquetes,n.componentInstance.onSaveComplete.subscribe(()=>{this.fetchPaquetes()})}openComprarModal(e){let n=this.modal.open(pe,{size:"300px",animation:!0,centered:!0});n.componentInstance.paquete=e}ngOnDestroy(){}},D.\u0275fac=function(n){return new(n||D)},D.\u0275cmp=g({type:D,selectors:[["app-paquetes"]],standalone:!0,features:[v],decls:30,vars:3,consts:[["header-title",""],[1,"d-flex","flex-column","text-gray-900","fw-bold","my-1"],[1,"",2,"color","white"],[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],[1,"card","shadow","p-2","px-4"],[1,"d-flex","py-4","justify-content-between","align-items-center"],["data-kt-search-element","form","autocomplete","off",1,"position-relative"],["type","hidden"],[1,"ki-duotone","ki-magnifier","fs-2","search-icon","position-absolute","top-50","translate-middle-y","ms-4"],[1,"path1"],[1,"path2"],["type","search","id","paquete-search","name","search","value","","placeholder","B\xFAsqueda","data-kt-search-element","input",1,"form-control","custom-form-control","ps-13",3,"input"],[1,"d-flex","align-items-center","gap-3"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"ki-solid","ki-plus","text-white","fs-1"],[1,"text-white","ms-2"],["id","myGrid",2,"height","400px",3,"ngClass"],["loadingMessage","Cargando...",2,"width","100%","height","100%",3,"gridReady","rowData","localeText","columnDefs","pagination","enableCellTextSelection","loading"]],template:function(n,t){n&1&&(r(0,"app-header"),ye(1,0),r(2,"h1",1)(3,"span",2),l(4,"Paquetes"),i()(),_e(),i(),r(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"form",7),o(10,"input",8),r(11,"i",9),o(12,"span",10)(13,"span",11),i(),r(14,"input",12),d("input",function(){return t.onFilterTextBoxChanged()}),i()(),r(15,"div",13)(16,"button",14),d("click",function(){return t.loadTabla()}),r(17,"span",15),o(18,"span",16),r(19,"span",17),l(20,"Actualizar"),i()()(),r(21,"button",18),d("click",function(){return t.openCrearModal()}),r(22,"span",15),o(23,"span",19),r(24,"span",20),l(25,"A\xF1adir"),i()()()()(),r(26,"div",21),_(27,tt,3,10),ve(28,27,Ze),qe(),i()()()()),n&2&&(u(26),f("ngClass",Fe(1,et,t.theme.getThemeMode()==="light"?"ag-theme-quartz":"ag-theme-quartz-dark")))},dependencies:[S,Ie,Me]}),D);Qe=w([B()],Qe);export{Qe as PaquetesComponent};
