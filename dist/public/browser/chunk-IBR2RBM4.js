import{a as ee}from"./chunk-CIJVB6CA.js";import{a as g}from"./chunk-5LYL3YTM.js";import{a as Z}from"./chunk-M5KBHNQG.js";import{a as U}from"./chunk-GT4JH6HJ.js";import{a as X,b}from"./chunk-KG3B2A6X.js";import{a as Q}from"./chunk-U2EAJGNN.js";import{u as K}from"./chunk-TEKV2OXA.js";import{a as J}from"./chunk-NMGGHNE5.js";import{a as $}from"./chunk-BIMAMPZW.js";import{a as Y}from"./chunk-KNEUCQQI.js";import"./chunk-GKZUPR7X.js";import{i as f,k as u}from"./chunk-ZM3MROS5.js";import{j as B,m as H,t as q,u as G,v as V}from"./chunk-DP3M2V7L.js";import{Aa as F,C,Gc as N,Ic as W,Ka as E,La as I,Lb as z,Nc as _,Oc as y,Pb as A,Rb as O,S as v,Ub as x,bc as a,cc as o,dc as m,dd as h,ec as M,fc as L,hc as j,n as w,nc as D,oc as S,v as R,vb as P,w as T,wa as l,wb as d,y as c,yc as p}from"./chunk-B7JMKZ3I.js";var ie=()=>[q,import("./chunk-TDDSBCRP.js").then(s=>s.AgGridAngular)],re=s=>[s];function ae(s,t){if(s&1){let e=j();a(0,"ag-grid-angular",17),_(1,"async"),_(2,"async"),D("gridReady",function(i){E(e);let n=S();return I(n.gridReady(i))}),o()}if(s&2){let e=S();x("rowData",y(1,7,e.citas))("columnDefs",e.colDefs)("loading",y(2,9,e.isLoading))("localeText",e.localeText)("enableCellTextSelection",!0)("ariaHidden",!0)("pagination",!0)}}function ne(s,t){s&1&&(a(0,"div",18)(1,"div",19)(2,"span",20),p(3,"Loading..."),o()()())}var te=class k{constructor(t,e,r,i){this.route=t,this.changeDetector=e,this.router=r,this.citaService=i,this.localeText=Q,this.isLoading=l(J).isLoading,this.theme=l(Y),this.authService=l($),this.datePipe=l(G),this.personalService=l(Z),this.citas=new w,this.user=this.authService.user(),this.autoSizeStrategy={type:"fitCellContents"},this.colDefs=[{field:"title",headerName:"Paciente",filter:!0,minWidth:250},{field:"tipocita",headerName:"Tipo de Cita",filter:!0},{field:"date",headerName:"Fecha de Cita",valueFormatter:n=>B(n.value,"dd/MM/yyyy","en"),cellRenderer:n=>`<span class="d-flex gap-2 align-items-center"><i class="ki-outline ki-calendar text-gray-900 fs-2"></i>${n.value}</span>`,filter:"agDateColumnFilter"},{field:"start",headerName:"Hora de Inicio",filter:!0,cellRenderer:n=>`<span class="d-flex gap-2 align-items-center"><i class="ki-outline ki-time text-gray-900 fs-2"></i>${this.datePipe.transform(new Date(n.value),"hh:mm")}</span>`},{field:"end",headerName:"Hora de Fin",filter:!0,cellRenderer:n=>`<span class="d-flex gap-2 align-items-center"><i class="ki-outline ki-time text-gray-900 fs-2"></i>${this.datePipe.transform(new Date(n.value),"hh:mm")}</span>`},{field:"estado",headerName:"Estado",filter:!0,cellRenderer:ee}]}ngOnInit(){U("#dateRangePicker",{mode:"range",dateFormat:"Y-m-d",onClose:t=>{if(t.length===2){let[e,r]=t;this.filtrarCitasPorFechas(e.toISOString(),r.toISOString())}}}),this.loadCitas()}filtrarCitasPorFechas(t,e){let r=this.user?.personal?.id_personal;if(!r){console.error("ID del personal no disponible");return}this.citas=this.citaService.getCitasByFecha(r,t,e).pipe(C(i=>(console.log("Citas filtradas:",i.data),i.data)),v(i=>(console.error("Error al filtrar citas:",i),c([]))),b(this))}loadCitas(){if(!this.user?.personal){console.log("Mostrar aviso que no tiene personal asignado el usuario");return}let t=this.user?.personal?.id_personal,e=new Date,r=new Date;r.setDate(e.getDate()+7),t?this.citas=this.citaService.getCitasByPersonal({id_personal:t,startWeek:e.toISOString(),endWeek:r.toISOString()}).pipe(C(i=>(console.log("Respuesta del backend:",i),i.data)),v(i=>(console.error("Error al cargar citas:",i),c([]))),b(this)):(console.error("ID personal no disponible"),this.citas=c([]))}gridReady(t){this.gridApi=t.api,this.sizeColumnsToFit()}sizeColumnsToFit(){let t=()=>this.gridApi.sizeColumnsToFit();new ResizeObserver(()=>{window.innerWidth>=768&&t()}).observe(document.body),t()}static{this.\u0275fac=function(e){return new(e||k)(d(f),d(h),d(u),d(g))}}static{this.\u0275cmp=F({type:k,selectors:[["app-dashboard"]],standalone:!0,features:[N],decls:24,vars:3,consts:[["header-title",""],[1,"d-flex","text-gray-900","fw-bold","align-items-center","gap-2"],[1,"ki-duotone","ki-calendar","text-white","fs-2tx",2,"vertical-align","middle"],[1,"path1"],[1,"path2"],[1,"",2,"color","white"],[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],[1,"card","shadow","p-2","px-4"],[1,"d-flex","py-4","justify-content-between","align-items-center"],[1,"d-flex","gap-3","w-100"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2"],["id","dateRangePicker","placeholder","Selecciona un rango de Fechas",1,"btn","btn-sm","btn-light","d-flex","ms-auto","px-4"],[2,"height","350px",3,"ngClass"],["loadingMessage","Cargando...",2,"width","100%","height","100%",3,"gridReady","rowData","columnDefs","loading","localeText","enableCellTextSelection","ariaHidden","pagination"],[1,"d-flex","justify-content-center","align-items-center",2,"height","100%"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(e,r){e&1&&(a(0,"app-header"),M(1,0),a(2,"h1",1)(3,"i",2),m(4,"span",3)(5,"span",4),o(),a(6,"span",5),p(7,"Mis Terapias"),o()(),L(),o(),a(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"button",11),D("click",function(){return r.loadCitas()}),a(14,"span",12),m(15,"span",13),a(16,"span",14),p(17,"Actualizar"),o()()(),m(18,"input",15),o()(),a(19,"div",16),z(20,ae,3,11)(21,ne,4,0),A(22,20,ie,21),O(),o()()()()),e&2&&(P(19),x("ngClass",W(1,re,r.theme.getThemeMode()==="light"?"ag-theme-quartz":"ag-theme-quartz-dark")))},dependencies:[V,H,K]})}};te=R([X({checkProperties:!0}),T("design:paramtypes",[f,h,u,g])],te);export{te as DashboardComponent};
