import{a as re}from"./chunk-37H2OG2C.js";import{a as ne,b as oe}from"./chunk-FKRAWMO5.js";import{a as ie}from"./chunk-MYRVSVX3.js";import{o as C,t as Z,u as ee,v as te}from"./chunk-FWMYVGKL.js";import{a as k}from"./chunk-PQDQNIDX.js";import{b as P}from"./chunk-OIXA5WM3.js";import{D as U,E as T,F as $,G as H,J,K,M as Q,P as W,V as X,X as Y,e as z,f as y,i as x,k as I}from"./chunk-MFZOMSUD.js";import{Ab as B,Ac as r,B as w,Ba as p,Bc as F,Cc as V,Fa as _,Fc as S,I as L,Lc as h,Mc as b,Ob as g,Pa as N,Qa as q,Xb as v,Ya as A,ec as e,fc as t,gc as c,hc as D,ic as O,kc as j,qc as u,rc as G,t as M,ub as R,uc as E,zb as s}from"./chunk-JQJUQ5FW.js";function me(a,i){a&1&&(e(0,"div")(1,"small",19),r(2,"La cantidad debe ser mayor que 0."),t()())}function ce(a,i){a&1&&c(0,"span",20)}var ae=(()=>{let i=class i{constructor(d){this.fb=d,this.modal=p(C),this.loadingService=p(k),this.authService=p(P),this.solicitudInventarioService=p(ee),this.isLoading=this.loadingService.isLoading,this.user=this.authService.user(),this.onRequestComplete=new A,this.solicitarForm=this.fb.group({cantidad_solicitar:["",[T.required,T.min(1)]]})}close(){this.modal.dismissAll()}sendRequest(){if(this.solicitarForm.invalid){console.error("El formulario no es v\xE1lido.");return}let d=this.solicitarForm.get("cantidad_solicitar")?.value,m=this.user?.personal?.id_personal,n=this.user?.personal?.terapia?.id_terapia;if(this.inventarioId===void 0){console.error("inventarioId no est\xE1 definido.");return}if(!m){console.error("No se encontr\xF3 el id_personal del usuario logueado.");return}if(!n){console.error("No se encontr\xF3 el id_terapia del usuario logueado.");return}this.loadingService.startLoading(),this.solicitudInventarioService.enviarSolicitud(m,this.inventarioId.toString(),d,n).subscribe({next:()=>{console.log("Solicitud de stock enviada exitosamente."),this.onRequestComplete.emit()},error:l=>{console.error("Error al enviar la solicitud:",l)},complete:()=>{this.loadingService.stopLoading(),this.close()}})}};i.\u0275fac=function(m){return new(m||i)(B(X))},i.\u0275cmp=_({type:i,selectors:[["app-solicitar-modal"]],inputs:{inventarioId:"inventarioId"},outputs:{onRequestComplete:"onRequestComplete"},standalone:!0,features:[S],decls:27,vars:8,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title","d-flex","align-items-center","gap-1"],[1,"text-primary"],[1,"ki-duotone","ki-add-files","text-gray-900","fs-1",2,"vertical-align","text-top"],[1,"path1"],[1,"path2"],[1,"path3"],["type","button","aria-label","Close",1,"btn","btn-sm","btn-icon","btn-active-color-primary","btn-color-gray-800",3,"click"],[1,"ki-duotone","ki-cross-square","fs-1"],[1,"modal-body"],[1,"form","d-flex","flex-column","gap-4",3,"ngSubmit","formGroup"],[1,"form-group"],["for","cantidad_solicitar",1,"form-label"],["id","cantidad_solicitar","formControlName","cantidad_solicitar","type","number","placeholder","Ingresa la cantidad",1,"form-control"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm align-middle ms-2",4,"ngIf"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(m,n){if(m&1&&(e(0,"div",0)(1,"h4",1)(2,"span",2)(3,"i",3),c(4,"span",4)(5,"span",5)(6,"span",6),t()(),r(7," Solicitar Stock "),t(),e(8,"button",7),u("click",function(){return n.close()}),e(9,"i",8),c(10,"span",4)(11,"span",5),t()()(),e(12,"div",9)(13,"form",10),u("ngSubmit",function(){return n.sendRequest()}),e(14,"div",11)(15,"label",12),r(16,"Cantidad a Solicitar"),t(),c(17,"input",13),g(18,me,3,0,"div",14),t()()(),e(19,"div",15)(20,"button",16),u("click",function(){return n.close()}),r(21,"Cancelar"),t(),e(22,"button",17),h(23,"async"),u("click",function(){return n.sendRequest()}),r(24," Enviar solicitud "),g(25,ce,1,0,"span",18),h(26,"async"),t()()),m&2){let l;s(13),v("formGroup",n.solicitarForm),s(5),v("ngIf",((l=n.solicitarForm.get("cantidad_solicitar"))==null?null:l.invalid)&&(((l=n.solicitarForm.get("cantidad_solicitar"))==null?null:l.touched)||((l=n.solicitarForm.get("cantidad_solicitar"))==null?null:l.dirty))),s(4),v("disabled",n.solicitarForm.invalid||b(23,4,n.isLoading)),s(3),v("ngIf",b(26,6,n.isLoading))}},dependencies:[Y,J,U,K,$,H,Q,W,I,y,x]});let a=i;return a})();function pe(a,i){a&1&&(e(0,"div",20)(1,"div",21)(2,"span",22),r(3,"Cargando..."),t()()())}function ue(a,i){if(a&1){let o=j();e(0,"div",23)(1,"div",24)(2,"div",25),c(3,"img",26),t(),e(4,"div",27)(5,"h5",28),r(6),t(),e(7,"p",29),r(8),t(),e(9,"p",29)(10,"strong"),r(11,"Stock:"),t(),r(12),t(),e(13,"button",30),u("click",function(){let m=N(o).$implicit,n=G();return q(n.openSolicitarModal(m))}),c(14,"span",31),r(15," Solicitar "),t()()()()}if(a&2){let o=i.$implicit;s(3),E("src",o.banner_url,R),E("alt",o.nombre),s(3),F(o.nombre),s(2),F(o.descripcion),s(4),V(" ",o.stock,"")}}var f,le=(f=class{constructor(){this.inventarioService=p(re),this.isLoading=p(k).isLoading,this.theme=p(Z),this.modal=p(C),this.inventarioList=new M,this.localeText=ie}ngOnInit(){this.fetchInventario()}fetchInventario(){this.inventarioList=this.inventarioService.getAll().pipe(L(i=>(console.log("Inventario recibido:",i.data),i.data)),oe(this))}loadTabla(){this.fetchInventario()}gridReady(i){this.gridApi=i.api}onFilterTextBoxChanged(){this.gridApi.setGridOption("quickFilterText",document.getElementById("item-search").value)}openSolicitarModal(i){let o=this.modal.open(ae,{size:"300px",animation:!0,centered:!0});o.componentInstance.inventarioId=i.id,o.componentInstance.onRequestComplete.subscribe(()=>{this.fetchInventario()})}ngOnDestroy(){}},f.\u0275fac=function(o){return new(o||f)},f.\u0275cmp=_({type:f,selectors:[["app-inventario"]],standalone:!0,features:[S],decls:25,vars:6,consts:[["header-title",""],[1,"d-flex","flex-column","text-gray-900","fw-bold","my-1"],[1,"",2,"color","white"],[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"container-xxl"],[1,"d-flex","py-4","justify-content-between","align-items-center"],["data-kt-search-element","form","autocomplete","off",1,"position-relative"],["type","hidden"],[1,"ki-duotone","ki-magnifier","fs-2","search-icon","position-absolute","top-50","translate-middle-y","ms-4"],[1,"path1"],[1,"path2"],["type","search","id","item-search","name","search","placeholder","B\xFAsqueda","data-kt-search-element","input",1,"form-control","custom-form-control","ps-13",3,"input"],[1,"d-flex","align-items-center","gap-3"],["type","button",1,"btn","btn-light-primary",3,"click"],[1,"d-flex","align-items-center"],[1,"fa-solid","fa-rotate-right"],[1,"ms-2"],["class","loading-container d-flex justify-content-center align-items-center",4,"ngIf"],[1,"row"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"loading-container","d-flex","justify-content-center","align-items-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"col-md-4"],[1,"card","mb-4",2,"width","18rem","padding","5px"],[1,"image-container",2,"box-shadow","0 4px 8px rgba(0, 0, 0, 0.1)","border-radius","8px","overflow","hidden"],[1,"card-img-top",2,"width","100%","height","auto",3,"src","alt"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["type","button",1,"btn","btn-primary","btn-lg","w-100","d-flex","justify-content-center","align-items-center",3,"click"],[1,"ki-solid","ki-plus","text-white","fs-1"]],template:function(o,d){o&1&&(e(0,"app-header"),D(1,0),e(2,"h1",1)(3,"span",2),r(4,"Inventario"),t()(),O(),t(),e(5,"div",3)(6,"div",4)(7,"div",5)(8,"form",6),c(9,"input",7),e(10,"i",8),c(11,"span",9)(12,"span",10),t(),e(13,"input",11),u("input",function(){return d.onFilterTextBoxChanged()}),t()(),e(14,"div",12)(15,"button",13),u("click",function(){return d.loadTabla()}),e(16,"span",14),c(17,"span",15),e(18,"span",16),r(19,"Actualizar"),t()()()()(),g(20,pe,4,0,"div",17),h(21,"async"),e(22,"div",18),g(23,ue,16,5,"div",19),h(24,"async"),t()()()),o&2&&(s(20),v("ngIf",b(21,2,d.isLoading)),s(3),v("ngForOf",b(24,4,d.inventarioList)))},dependencies:[I,z,y,x,te]}),f);le=w([ne()],le);export{le as InventarioComponent};
