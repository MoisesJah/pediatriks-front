import{a as w,b as _}from"./chunk-QD4WZRKA.js";import{a as M,b as I,c as C}from"./chunk-MBR5BSI5.js";import{a as b}from"./chunk-MJY4KJR5.js";import{a as S}from"./chunk-D4MMWRT4.js";import{a as g}from"./chunk-5LYL3YTM.js";import{a as y}from"./chunk-KG3B2A6X.js";import{a as v}from"./chunk-KNEUCQQI.js";import"./chunk-GKZUPR7X.js";import{i as l}from"./chunk-ZM3MROS5.js";import"./chunk-DP3M2V7L.js";import{Aa as d,Gc as p,Ub as c,bc as h,cc as f,dc as u,f as a,v as n,vb as m,wa as t}from"./chunk-B7JMKZ3I.js";var D=a(M()),r=a(w()),G=a(_());var F=class s{constructor(){this.route=t(l),this.theme=t(v),this.fichaId=this.route.snapshot.paramMap.get("surveyId"),this.sesionId=this.route.snapshot.paramMap.get("sesionId"),this.fichaService=t(S),this.citaService=t(g),this.fichaResult=t(b)}ngOnInit(){this.getFicha()}mergePaciente(i){this.citaService.getPacienteInfo(this.sesionId).subscribe(e=>{i.mergeData({nombres:e.data.nombres,diagnostico:e.data.diagnostico,apoderado:e.data.apoderado,fecha_nacimiento:e.data.fecha_nacimiento,edad:e.data.edad,personal:e.data.personal,telefono:e.data.telefono,colegio:e.data.colegio})})}getFicha(){this.fichaService.getById(this.fichaId).subscribe(i=>{this.survey=new D.Model(i.data.body),this.survey.locale="es",this.survey.applyTheme(this.theme.getThemeMode()==="dark"?r.DefaultDark:r.DefaultLight),this.survey.completedHtml="<h3>Ficha Completada!</h3>",this.mergePaciente(this.survey),this.survey.onComplete.add((e,o)=>{o.showSaveInProgress(),this.fichaResult.create({id_sesion:this.sesionId,id_ficha:this.fichaId,body:JSON.stringify(e.data)}).subscribe({next:()=>{o.showSaveSuccess("Ficha Guardada Correctamente!")},error:()=>{o.showSaveError()}})})})}ngAfterViewInit(){}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275cmp=d({type:s,selectors:[["app-survey"]],standalone:!0,features:[p],decls:2,vars:1,consts:[[1,"ficha-container"],[3,"model"]],template:function(e,o){e&1&&(h(0,"div",0),u(1,"survey",1),f()),e&2&&(m(),c("model",o.survey))},dependencies:[C,I]})}};F=n([y()],F);export{F as SurveyComponent};
